df$PrecipSum34_44 <- dplyr::lead(df$PrecipSum23_33, n = 11)
#Code check
c(sum=sum(df[34:44,10]), metric=df[1,24]) #sum() calculation should match metric
#PrecipSum column that looks back 19 days from hatch date
df$PrecipSumIncubation <- zoo::rollapply(df$Precip, width=19, FUN=sum, align = 'right', fill = NA, partial = TRUE, na.rm = TRUE)
#Code check
c(sum=sum(df[11:29,10], na.rm = TRUE), metric=df[29,24]) #sum() calculation should match metric
#PrecipSum column that looks back 19 days from hatch date
df$PrecipSumIncubation <- zoo::rollapply(df$Precip, width=19, FUN=sum, align = 'right', fill = NA, partial = TRUE, na.rm = TRUE)
#Code check
c(sum=sum(df[11:29,10], na.rm = TRUE), metric=df[29,25]) #sum() calculation should match metric
print(df[11:29,10])#19 values
View(df)
#PrecipSum column that looks back 19 days from hatch date
df$PrecipSumIncubation <- zoo::rollapply(df$Precip, width=19, FUN=sum, align = 'right', fill = NA, partial = TRUE, na.rm = TRUE)
#Code check
c(sum=sum(df[1:11,15], na.rm = TRUE), metric=df[1,26]) #sum() calculation should match metric
df$GDDSum1_11 <- zoo::rollapply(df$GDD, width=11, FUN=sum, align = 'left', fill = NA, partial = TRUE, na.rm = TRUE)
#Code check
c(sum=sum(df[11:29,10], na.rm = TRUE), metric=df[29,25]) #sum() calculation should match metric
#PrecipSum column that looks back 19 days from hatch date
df$PrecipSumIncubation <- zoo::rollapply(df$Precip, width=19, FUN=sum, align = 'right', fill = NA, partial = TRUE, na.rm = TRUE)
#Code check
c(sum=sum(df[1:11,10], na.rm = TRUE), metric=df[1,25]) #sum() calculation should match metric
#Code check
c(sum=sum(df[1:19,10], na.rm = TRUE), metric=df[19,25]) #sum() calculation should match metric
print(df[1:19,10])#19 values
#Code check
c(sum=sum(df[1:19,15], na.rm = TRUE), metric=df[19,25]) #sum() calculation should match metric
#Code check
c(sum=sum(df[1:19,15], na.rm = TRUE), metric=df[19,26]) #sum() calculation should match metric
#Code check
c(sum=sum(df[1:19,15], na.rm = TRUE), metric=df[1,26]) #sum() calculation should match metric
#Code check
c(sum=sum(df[1:11,15], na.rm = TRUE), metric=df[1,26]) #sum() calculation should match metric
#Code check
c(sum=sum(df[12:22,15], na.rm = TRUE), metric=df[12,26]) #sum() calculation should match metric
#Code check
c(sum=sum(df[112:122,15], na.rm = TRUE), metric=df[122,26]) #sum() calculation should match metric
#Code check
c(sum=sum(df[112:122,15], na.rm = TRUE), metric=df[112,26]) #sum() calculation should match metric
print(df[112:122,15])
#GDDSum column that is 11 days ahead
df$GDDSum12_22 <- dplyr::lead(df$GDDSum1_11, n = 11)
#Code check
c(sum=sum(df[12:22,15], na.rm = TRUE), metric=df[1,27]) #sum() calculation should match metric
print(df[12:22,10])
print(df[12:22,15])
#Code check
c(sum=sum(df[14:24,15], na.rm = TRUE), metric=df[3,27]) #sum() calculation should match metric
print(df[14:24,15])
#Code check
c(sum=sum(df[12:22,15], na.rm = TRUE), metric=df[1,27]) #sum() calculation should match metric
#GDDSum column that is 11 days ahead
df$GDDSum12_22 <- dplyr::lead(df$GDDSum1_11, n = 11)
#Code check
c(sum=sum(df[66:77,15], na.rm = TRUE), metric=df[55,27]) #sum() calculation should match metric
#Code check
c(sum=sum(df[66:76,15], na.rm = TRUE), metric=df[55,27]) #sum() calculation should match metric
print(df[66:76,15])
#GDDSum column that is 22 days ahead
df$GDDSum23_33 <- dplyr::lead(df$GDDSum12_22, n = 11)
#Code check
c(sum=sum(df[66:76,15], na.rm = TRUE), metric=df[44,28]) #sum() calculation should match metric
#GDDSum column that is 22 days ahead
df$GDDSum23_33 <- dplyr::lead(df$GDDSum12_22, n = 11)
#Code check
c(sum=sum(df[66:76,15], na.rm = TRUE), metric=df[44,28]) #sum() calculation should match metric
#GDDSum column that is 33 days ahead
df$GDDSum34_44 <- dplyr::lead(df$GDDSum23_33, n = 11)
#Code check
c(sum=sum(df[66:76,15], na.rm = TRUE), metric=df[33,29]) #sum() calculation should match metric
#GDDSum for the 19 days preceding hatch date
df$GDDSumIncubation <- zoo::rollapply(df$HDD, width=19, FUN=sum, align = 'right', fill = NA, partial = TRUE, na.rm = TRUE)
#GDDSum for the 19 days preceding hatch date
df$GDDSumIncubation <- zoo::rollapply(df$GDD, width=19, FUN=sum, align = 'right', fill = NA, partial = TRUE, na.rm = TRUE)
#GDDSum for the 19 days preceding hatch date
df$GDDSumIncubation <- zoo::rollapply(df$GDD, width=19, FUN=sum, align = 'right', fill = NA, partial = TRUE, na.rm = TRUE)
```{r}
#code check
c(sum=sum(df[111:129,15], na.rm = TRUE), metric=df[129,30]) #sum() should match metric
print(df[111:129,15])
#GDDSum for the 19 days preceding hatch date
df$GDDSumIncubation <- zoo::rollapply(df$GDD, width=19, FUN=sum, align = 'right', fill = NA, partial = TRUE, na.rm = TRUE)
#code check
c(sum=sum(df[111:129,15], na.rm = TRUE), metric=df[129,30]) #sum() should match metric
print(df[111:129,15])#19 values
#CDDSum column the first 11 days
df$CDDSum1_11 <- zoo::rollapply(df$CDD, width=11, FUN=sum, align = 'left', fill = NA, partial = TRUE, na.rm = TRUE)
#Code check
c(sum=sum(df[112:122,14], na.rm = TRUE), metric=df[112,31]) #sum() calculation should match metric
print(df[112:122,14])#11 values
#CDDSum column that is 11 days ahead
df$CDDSum12_22 <- dplyr::lead(df$CDDSum1_11, n = 11)
#Code check
c(sum=sum(df[66:76,14], na.rm = TRUE), metric=df[55,32]) #sum() calculation should match metric
#Code check
c(sum=sum(df[66:76,14], na.rm = TRUE), metric=df[55,32]) #sum() calculation should match metric
```{r}
print(df[66:76,14])
#CDDSum column that is 22 days ahead
df$CDDSum23_33 <- dplyr::lead(df$CDDSum12_22, n = 11)
#Code check
c(sum=sum(df[66:76,14], na.rm = TRUE), metric=df[44,33]) #sum() calculation should match metric
#CDDSum column that is 33 days ahead
df$CDDSum34_44 <- dplyr::lead(df$CDDSum23_33, n = 11)
#Code check
c(sum=sum(df[66:76,14], na.rm = TRUE), metric=df[33,34]) #sum() should match metric
#CDDSum for the 19 days preceding hatch date
df$CDDSumIncubation <- zoo::rollapply(df$CDD, width=19, FUN=sum, align = 'right', fill = NA, partial = TRUE, na.rm = TRUE)
#code check
c(sum=sum(df[111:129,14], na.rm = TRUE), metric=df[129,35]) #sum() should match metric
print(df[111:129,14])#19 values
print(df[111:129,14])#19 values
View(df)
#New dataframe with the derived climate metrics
ClimateMetrics.df <- as.data.frame(df[60:11514,c(1:7,10,14-35)])
#New dataframe with the derived climate metrics
ClimateMetrics.df <- as.data.frame(df[60:11514,c(1:7,10,14:35)])
View(ClimateMetrics.df)
write.csv(ClimateMetrics.df, "C:\\Users\\Justin Mann\\Documents\\RProjects\\CrowBase\\ClimateMetrics.csv",
row.names = FALSE)
>>>>>>> e71a7dcc4a760bde4c90604e7f49aca36a46b687
library(tidyverse)
library(dplyr)
library(broom) #tidy() to create tibbles from model summaries
library(car) #vif
library(cowplot)
library(lme4) #frequentist models
library(sjPlot) #plot_model & tab_model (blue = #377EB8)
library(ggpubr) #ggarrange
library(glmmTMB) #zi & overdispersed models
library(lmerTest) #lmerTest::step
library(ggeffects) #ggpredict
#PACKAGES FOR BAYESIAN MODELS
# library(rstanarm) #stan models
# library(shinystan) #stan model evaluation
#launch_shinystan_demo()
# library(loo) #use loo() to compare fits between bayesian models
library(plotly)
library(MuMIn) #dredge() for unsupervised model selection
library(AICcmodavg) #aictab() for AICc model comparisons
library(DHARMa)
theme_set(theme_classic())
#Both sexes
B.df <- read.csv("CrowNestlingClimate_BothSexesClean.csv",h=TRUE)
B.df$AllSex <- as.factor(B.df$AllSex)
summary(B.df)
B.df$BDbyWeight <- B.df$BillDepth/B.df$Weight
B.df$UBbyWeight <- B.df$UB/B.df$Weight
B.df$UBSbyWeight <- B.df$UBS/B.df$Weight
B.df$TBSbyWeight <- B.df$TBS/B.df$Weight
B.df$TarsusbyWeight <- B.df$Tarsus/B.df$Weight
?scale()
B.factors.df <- B.df[,1:5]
B.scaled.df <- scale(B.df[,6:32])
B.scaled.df <- cbind(B.factors.df,B.scaled.df)
#Males
M.df <- subset(B.df, AllSex=="M")
M.scaled.df <- subset(B.scaled.df, AllSex=="M")
#Females
F.df <- subset(B.df, AllSex=="F")
F.scaled.df <- subset(B.scaled.df, AllSex=="F")
BDResids <- lm(data = B.scaled.df, BillDepth ~ Weight + CalcAge)
BDResids.mdl <- lm(data = B.scaled.df, BillDepth ~ Weight + CalcAge)
B.scaled.df$BDResids <- BDResids.mdl$residuals
hist(BDResids)
hist(B.scaled.df$BDResids)
ggplot(data = B.scaled.df, aes(x=BDResids))+
geom_histogram()
ggplot(data = B.scaled.df, aes(x=BDResids, color = AllSex))+
geom_histogram()
ggplot(data = B.scaled.df, aes(x=BDResids, fill = AllSex))+
geom_histogram()+
scale_fill_manual(values = c("#009E73","#E69F00"), labels = c("Female","Male"))
t.test(B.scaled.df$BDResids[B.scaled.df$AllSex=="M"],B.scaled.df$BDResids[B.scaled.df$AllSex=="F"])
UBSResids.mdl <- lm(data = B.scaled.df, UBS ~ Weight + CalcAge)
B.scaled.df$UBSResids <- UBSResids.mdl$residuals
ggplot(data = B.scaled.df, aes(x=UBSResids, fill = AllSex))+
geom_histogram()+
scale_fill_manual(values = c("#009E73","#E69F00"), labels = c("Female","Male"))
t.test(B.scaled.df$UBSResids[B.scaled.df$AllSex=="M"],B.scaled.df$UBSResids[B.scaled.df$AllSex=="F"])
BDResidsSex.mdl <- lm(data = B.scaled.df, BillDepth ~ Weight + CalcAge + AllSex)
library(tidyverse)
library(dplyr)
library(broom) #tidy() to create tibbles from model summaries
library(car) #vif
library(cowplot)
library(lme4) #frequentist models
library(sjPlot) #plot_model & tab_model (blue = #377EB8)
library(ggpubr) #ggarrange
library(glmmTMB) #zi & overdispersed models
library(lmerTest) #lmerTest::step
library(ggeffects) #ggpredict
#PACKAGES FOR BAYESIAN MODELS
# library(rstanarm) #stan models
# library(shinystan) #stan model evaluation
#launch_shinystan_demo()
# library(loo) #use loo() to compare fits between bayesian models
library(plotly)
library(MuMIn) #dredge() for unsupervised model selection
library(AICcmodavg) #aictab() for AICc model comparisons
library(DHARMa)
theme_set(theme_classic())
#Both sexes
B.df <- read.csv("CrowNestlingClimate_BothSexesClean.csv",h=TRUE)
B.df$AllSex <- as.factor(B.df$AllSex)
summary(B.df)
B.df$BDbyWeight <- B.df$BillDepth/B.df$Weight
B.df$UBbyWeight <- B.df$UB/B.df$Weight
B.df$UBSbyWeight <- B.df$UBS/B.df$Weight
B.df$TBSbyWeight <- B.df$TBS/B.df$Weight
B.df$TarsusbyWeight <- B.df$Tarsus/B.df$Weight
?scale()
B.factors.df <- B.df[,1:5]
B.scaled.df <- scale(B.df[,6:32])
B.scaled.df <- cbind(B.factors.df,B.scaled.df)
#Males
M.df <- subset(B.df, AllSex=="M")
M.scaled.df <- subset(B.scaled.df, AllSex=="M")
#Females
F.df <- subset(B.df, AllSex=="F")
F.scaled.df <- subset(B.scaled.df, AllSex=="F")
t.test(B.df$Weight[B.df$AllSex=="M"], B.df$Weight[B.df$AllSex=="F"])
t.test(B.df$UBSbyWeight[B.df$AllSex=="M"],B.df$UBSbyWeight[B.df$AllSex=="F"])
t.test(B.scaled.df$UBSbyWeight[B.scaled.df$AllSex=="M"],B.scaled.df$UBSbyWeight[B.scaled.df$AllSex=="F"])
t.test(B.df$BDbyWeight[B.df$AllSex=="M"],B.df$BDbyWeight[B.df$AllSex=="F"])
t.test(B.scaled.df$BillDepth[B.scaled.df$AllSex=="M"],B.scaled.df$BillDepth[B.scaled.df$AllSex=="F"])
t.test(B.df$UBbyWeight[B.df$AllSex=="M"],B.df$UBbyWeight[B.df$AllSex=="F"])
t.test(B.df$TBSbyWeight[B.df$AllSex=="M"],B.df$TBSbyWeight[B.df$AllSex=="F"])
t.test(B.df$Tarsus[B.df$AllSex=="M"], B.df$Tarsus[B.df$AllSex=="F"])
UBSByWeightGDD.plot <- ggplot(data = B.df, aes(x=GDDSum12_22, y=UBSbyWeight, color=AllSex))+
geom_point(size = 1.2)+
geom_smooth()+
scale_color_manual(values = c("#009E73","#E69F00"), labels = c("Female","Male"))+
labs(color = "Sex")+
ylab("UBS/Weight Ratio")+
xlab("GDD")+
theme(plot.title = element_text(size = 22),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 14),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 14),
legend.position = "top",
plot.margin = margin(15,15,15,15))
UBSByWeightGDD.plot
#cowplot::save_plot("UBSByWeightGDD.plot.png", UBSByWeightGDD.plot)
BDByWeightGDD.plot <- ggplot(data = B.df, aes(x=GDDSum12_22, y=BDbyWeight, color=AllSex))+
geom_point(size = 1.2)+
geom_smooth()+
scale_color_manual(values = c("#009E73","#E69F00"), labels = c("Female","Male"))+
labs(color = "Sex")+
ylab("BD/Weight Ratio")+
xlab("GDD")+
theme(plot.title = element_text(size = 22),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 14),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 14),
legend.position = "top",
plot.margin = margin(15,15,15,15))
BDByWeightGDD.plot
cowplot::save_plot("BDByWeightGDD.plot.png", BDByWeightGDD.plot)
BDGDD.plot <- ggplot(data = B.df, aes(x=GDDSum12_22, y=BillDepth, color=AllSex))+
geom_point(size = 1.2)+
geom_smooth()+
scale_color_manual(values = c("#009E73","#E69F00"), labels = c("Female","Male"))+
labs(color = "Sex")+
ylab("Bill Depth")+
xlab("GDD")+
theme(plot.title = element_text(size = 22),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 14),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 14),
legend.position = "top",
plot.margin = margin(15,15,15,15))
BDGDD.plot
#cowplot::save_plot("UBSByWeightGDD.plot.png", UBSByWeightGDD.plot)
WeightGDD.plot <- ggplot(data = B.df, aes(x=GDDSum12_22, y=Weight, color=AllSex))+
geom_point(size = 1.2)+
geom_smooth()+
scale_color_manual(values = c("#009E73","#E69F00"), labels = c("Female","Male"))+
labs(color = "Sex")+
ylab("Weight")+
xlab("GDD")+
theme(plot.title = element_text(size = 22),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 14),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 14),
legend.position = "top",
plot.margin = margin(15,15,15,15))
WeightGDD.plot
#cowplot::save_plot("WeightGDD.plot.png", WeightGDD.plot)
WeightPrecip.plot <- ggplot(data = B.df, aes(x=PrecipSum12_22, y=Weight, color=AllSex))+
geom_point(size = 1.2)+
geom_smooth()+
scale_color_manual(values = c("#009E73","#E69F00"), labels = c("Female","Male"))+
labs(color = "Sex")+
ylab("Weight")+
xlab("Precip")+
theme(plot.title = element_text(size = 22),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 14),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 14),
legend.position = "top",
plot.margin = margin(15,15,15,15))
WeightPrecip.plot
#cowplot::save_plot("WeightPrecip.plot.png", WeightPrecip.plot)
BDResids.mdl <- lm(data = B.scaled.df, BillDepth ~ Weight + CalcAge)
BDResidsSex.mdl <- lm(data = B.scaled.df, BillDepth ~ Weight + CalcAge + AllSex)
B.scaled.df$BDResids <- BDResids.mdl$residuals
ggplot(data = B.scaled.df, aes(x=BDResids, fill = AllSex))+
geom_histogram()+
scale_fill_manual(values = c("#009E73","#E69F00"), labels = c("Female","Male"))
t.test(B.scaled.df$BDResids[B.scaled.df$AllSex=="M"],B.scaled.df$BDResids[B.scaled.df$AllSex=="F"])
UBSResids.mdl <- lm(data = B.scaled.df, UBS ~ Weight + CalcAge)
B.scaled.df$UBSResids <- UBSResids.mdl$residuals
ggplot(data = B.scaled.df, aes(x=UBSResids, fill = AllSex))+
geom_histogram()+
scale_fill_manual(values = c("#009E73","#E69F00"), labels = c("Female","Male"))
t.test(B.scaled.df$UBSResids[B.scaled.df$AllSex=="M"],B.scaled.df$UBSResids[B.scaled.df$AllSex=="F"])
BDResidsSex.mdl <- lm(data = B.scaled.df, BillDepth ~ Weight + CalcAge + AllSex)
t.test(B.scaled.df$BDResids[B.scaled.df$AllSex=="M"],B.scaled.df$BDResids[B.scaled.df$AllSex=="F"])
B.scaled.df$BDResidsSex <- BDResidsSex.mdl$residuals
ggplot(data = B.scaled.df, aes(x=BDResidsSex, fill = AllSex))+
geom_histogram()+
scale_fill_manual(values = c("#009E73","#E69F00"), labels = c("Female","Male"))
library(tidyverse)
library(dplyr)
library(broom) #tidy() to create tibbles from model summaries
library(car) #vif
library(cowplot)
library(lme4) #frequentist models
library(sjPlot) #plot_model & tab_model (blue = #377EB8)
library(ggpubr) #ggarrange
library(glmmTMB) #zi & overdispersed models
library(lmerTest) #lmerTest::step
library(ggeffects) #ggpredict
#PACKAGES FOR BAYESIAN MODELS
# library(rstanarm) #stan models
# library(shinystan) #stan model evaluation
#launch_shinystan_demo()
# library(loo) #use loo() to compare fits between bayesian models
library(plotly)
library(MuMIn) #dredge() for unsupervised model selection
library(AICcmodavg) #aictab() for AICc model comparisons
library(DHARMa)
library(DescTools)
theme_set(theme_classic())
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)
df <- df %>%
select(Year,NestName,ID,CalcAge,HatchDateJul,HatchDateJulYear,AllSex,BillNT,BillWidth,BillDepth,TEC,Head,UpperBill,UBillSurface,TotBillSurface,Skull,Tarsus,Weight)
View(df)
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)
df <- df %>%
select(Year,NestName,ID,FieldAge,CalcAge,HatchDateJul,HatchDateJulYear,AllSex,BillNT,BillWidth,BillDepth,TEC,Head,UpperBill,UBillSurface,TotBillSurface,Skull,Tarsus,Weight)
df <- df %>%
rename(BillNT=BNT)
df <- df %>%
rename(BNT=BillNT)
df <- df %>%
select(Year,NestName,ID,AgeField,CalcAge,HatchDateJul,HatchDateJulYear,AllSex,BillNT,BillWidth,BillDepth,TEC,Head,UpperBill,UBillSurface,TotBillSurface,Skull,Tarsus,Weight)
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)
df <- df %>%
select(Year,NestName,ID,AgeField,CalcAge,HatchDateJul,HatchDateJulYear,AllSex,BillNT,BillWidth,BillDepth,TEC,Head,UpperBill,UBillSurface,TotBillSurface,Skull,Tarsus,Weight)
df <- df %>%
rename(BNT=BillNT,BW=BillWidth,BD=BillDepth,UB=UpperBill,UBS=UBillSurface,TBS=TotBillSurface)
df <- df %>%
rename(FieldAge=AgeField,BNT=BillNT,BW=BillWidth,BD=BillDepth,UB=UpperBill,UBS=UBillSurface,TBS=TotBillSurface)
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)
df <- df %>%
select(Year,NestName,ID,AgeField,CalcAge,HatchDateJul,HatchDateJulYear,AllSex,BillNT,BillWidth,BillDepth,TEC,Head,UpperBill,UBillSurface,TotBillSurface,Skull,Tarsus,Weight)
df <- df %>%
rename(FieldAge=AgeField,BNT=BillNT,BW=BillWidth,BD=BillDepth,UB=UpperBill,UBS=UBillSurface,TBS=TotBillSurface)
WeightByFieldAge.plot <- ggplot(data = df, aes(x=FieldAge,y=Weight,label=ID,color=HatchDatJul))+
geom_point()
WeightByFieldAge.plot
WeightByFieldAge.plot <- ggplot(data = df, aes(x=FieldAge,y=Weight,label=ID,color=HatchDateJul))+
geom_point()
WeightByFieldAge.plot
df <- df %>%
drop_na(df)
df <- df %>%
drop_na(Weight)
WeightByFieldAge.plot <- ggplot(data = df, aes(x=FieldAge,y=Weight,label=ID,color=HatchDateJul))+
geom_point()
WeightByFieldAge.plot
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)
df <- df %>%
select(Year,NestName,ID,AgeField,CalcAge,HatchDateJul,HatchDateJulYear,AllSex,BillNT,BillWidth,BillDepth,TEC,Head,UpperBill,UBillSurface,TotBillSurface,Skull,Tarsus,Weight)
df <- df %>%
rename(FieldAge=AgeField,BNT=BillNT,BW=BillWidth,BD=BillDepth,UB=UpperBill,UBS=UBillSurface,TBS=TotBillSurface)
sapply(df, function(x) sum(is.na(x)))
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
df <- df %>%
filter_at(vars(Weight), all_vars(!is.na(.)))
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
df <- df %>%
filter_at(vars(Weight,HatchDateJul), all_vars(!is.na(.)))
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
df <- df %>%
filter_at(vars(Weight,HatchDateJul,BD), all_vars(!is.na(.)))
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
df <- df %>%
filter_at(vars(Weight,HatchDateJul,BD,Tarsus,Skull), all_vars(!is.na(.)))
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
df <- df %>%
filter_at(vars(Weight,HatchDateJul,BD,Tarsus,Skull,BW), all_vars(!is.na(.)))
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
WeightByFieldAge.plot <- ggplot(data = df, aes(x=FieldAge,y=Weight,label=ID,color=HatchDateJul))+
geom_point()
WeightByFieldAge.plot
WeightByFieldAge.plot <- ggplot(data = df, aes(x=FieldAge,y=Weight,label=ID,color=HatchDateJul))+
geom_point()
WeightByFieldAge.plot
ggplotly(WeightByFieldAge.plot)
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)
#Select pertinent variables
df <- df %>%
select(Year,Name,NestName,ID,AgeField,CalcAge,HatchDateJul,HatchDateJulYear,AllSex,BillNT,BillWidth,BillDepth,TEC,Head,UpperBill,UBillSurface,TotBillSurface,Skull,Tarsus,Weight)
#Rename variables
df <- df %>%
rename(FieldAge=AgeField,BNT=BillNT,BW=BillWidth,BD=BillDepth,UB=UpperBill,UBS=UBillSurface,TBS=TotBillSurface)
#Count NAs
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
df <- df %>% filter(!grepl("doa",Name))
WeightByFieldAge.plot <- ggplot(data = df, aes(x=FieldAge,y=Weight,label=ID,color=HatchDateJul))+
geom_point()
ggplotly(WeightByFieldAge.plot)
df <- df %>% filter(!grepl("doa|dead",Name))
WeightByFieldAge.plot <- ggplot(data = df, aes(x=FieldAge,y=Weight,label=ID,color=HatchDateJul))+
geom_point()
ggplotly(WeightByFieldAge.plot)
#filter out Weights < 160
df <- df %>% filter(Weight < 160)
WeightByFieldAge.plot <- ggplot(data = df, aes(x=FieldAge,y=Weight,label=ID,color=HatchDateJul))+
geom_point()
ggplotly(WeightByFieldAge.plot)
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)
#Select variables
df <- df %>%
select(Year,Name,NestName,ID,AgeField,CalcAge,HatchDateJul,HatchDateJulYear,AllSex,BillNT,BillWidth,BillDepth,TEC,Head,UpperBill,UBillSurface,TotBillSurface,Skull,Tarsus,Weight)
#Rename variables
df <- df %>%
rename(FieldAge=AgeField,BNT=BillNT,BW=BillWidth,BD=BillDepth,UB=UpperBill,UBS=UBillSurface,TBS=TotBillSurface)
#Count NAs
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
#Remove NAs
df <- df %>%
filter_at(vars(Weight,HatchDateJul,BD,Tarsus,Skull,BW), all_vars(!is.na(.)))
#Recount NAs
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
#filter out names with 'doa' or 'dead'
df <- df %>% filter(!grepl("doa|dead",Name))
#filter out Weights < 160
df <- df %>% filter(Weight > 160)
WeightByFieldAge.plot <- ggplot(data = df, aes(x=FieldAge,y=Weight,label=ID,color=HatchDateJul))+
geom_point()
ggplotly(WeightByFieldAge.plot)
View(df)
df <- df %>% filter(between(CalcAge, 24,30))
range(df$CalcAge)
range(df$Weight)
range(df$Weight)
ggplot(data = df, aes(x=CalcAge,y=Weight,label=ID))+
geom_point()
WeightByCalcAge.plot <- ggplot(data = df, aes(x=CalcAge,y=Weight,label=ID))+
geom_point()
ggplotly(WeightByCalcAge.plot)
climate.df <- read.csv("ClimateMetrics.csv", h=TRUE)
climate.df <- climate.df[,-c(1,3:4)]
df <- left_join(df,climate.df, by = "HatchDateJulYear")
View(df)
BD.mdl <- lm(data = df, BD ~ GDDSum12_22 * PrecipSum12_22 + Weight + CalcAge)
summary(BD.mdl)
NoScale.df <- df[,1:9]
Scale.df <- df[,10:20]
View(Scale.df)
View(df)
#drop Julian from dataframe
df <- df[,-21]
NoScale.df <- df[,1:9]
Scale.df <- df[,10:35]
scale(Scale.df)
Scale.df <- scale(Scale.df)
scaled.df <- cbind(NoScale.df,Scale.df)
View(scaled.df)
BD.scaled.mdl <- lm(data = scaled.df, BD ~ GDDSum12_22 * PrecipSum12_22 + Weight + CalcAge)
summary(BD.scaled.mdl)
WeightByFieldAge.plot <- ggplot(data = df, aes(x=FieldAge,y=Weight,label=ID,color=HatchDateJul))+
geom_point()
ggplotly(WeightByFieldAge.plot)
View(df)
library(tidyverse)
library(dplyr)
library(zoo)
df <- read.csv("IthacaWeatherData1989_2022.csv", h=TRUE)
df <- read.csv("IthacaWeatherData1989-2022.csv", h=TRUE)
df <- read.csv("IthacaWeatherData1989-2020.csv", h=TRUE)
View(df)
