length(df$lifeStage[df$lifeStage == "nestling"]) #4086 nestlings
length(df$lifeStage[df$lifeStage == "adult"]) #286 adults
#only individuals with multiple measurements (mm)
mm <- subset(df, df$indivCounts>1)
#only nestlings (ne)
ne <- subset(df, df$lifeStage == "nestling")
#only adults (ad)
ad <- subset(df, df$lifeStage == "adult")
range(df$weight)
#check n for both life stages
length(df$lifeStage[df$lifeStage == "nestling"]) #4086 nestlings
length(df$lifeStage[df$lifeStage == "adult"]) #286 adults
df <- tibble(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
df %>% range(weight)
View(df)
df %>% summary(weight)
df %>% sevenPrimary
df[sevenPrimary]
df$sevenPrimary
library(ggbiplot)
install.packages("remotes")
remotes::install_github("vqv/ggbiplot")
install.packages("remotes")
install.packages("remotes")
remotes::install_github("vqv/ggbiplot")
ggbiplot()
install.packages("ggfortify")
library(ggfortify)
install.packages("ggfortify")
library(ggfortify)
df <- tibble(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
library(tidyverse) #ggplot2, dplyr, tibble, etc.
library(knitr)
library(ggfortify)
library(Rtsne)
library(usethis) #git integration
library(glmmTMB)
library(lme4)
library(ggpubr) #ggarrange() figure wraps
library(plyr)
library(ggeffects) #ggpredict
library(rstanarm) #stan models
library(shinystan) #stan model evaluation >launch_shinystan_demo()
library(loo) #loo() to compare fits between bayesian models
library(MuMIn) #dredge, model averaging
library(RColorBrewer) ; brewer.pal(n=8, name = "Dark2")#; display.brewer.pal(n = 8, name = "Dark2")
theme_set(theme_classic())
df <- tibble(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
df$indivCounts <- as.numeric(ave(df$id, df$id, FUN = length))
#sorted by ascending year and lifeStage (add sorting conditions with: ', variableName')
df <- df %>% arrange(year, lifeStage)
#make lifeStage a factor
df$lifeStage <- as.factor(df$lifeStage)
#check n for both life stages
length(df$lifeStage[df$lifeStage == "nestling"]) #4086 nestlings
length(df$lifeStage[df$lifeStage == "adult"]) #286 adults
df %>% summary(weight)
#only individuals with multiple measurements (mm)
mm <- subset(df, df$indivCounts>1)
#only nestlings (ne)
ne <- subset(df, df$lifeStage == "nestling")
#only adults (ad)
ad <- subset(df, df$lifeStage == "adult")
#subset morphometric data from .ne
nestlMorph.ne <- ne[,c(1:23)] #n=4086
#drop NAs
nestlMorph.ne <- drop_na(nestlMorph.ne)#n=1413
#filter ages
nestlMorph.ne <- nestlMorph.ne %>% filter(between(age, 20, 30))#n=1237
#create morphometric matrix
nestlMorph.mat <- as.matrix(nestlMorph.ne[,-c(1:10,22)])
#run tSNE
nestlMorph.tsne <- Rtsne(nestlMorph.mat)
#subset morphometric data from .ne
nestlMorph.ne <- ne[,c(1:23)] #n=4086
#drop NAs
nestlMorph.ne <- drop_na(nestlMorph.ne)#n=1413
#filter ages
nestlMorph.ne <- nestlMorph.ne %>% filter(between(age, 20, 30))#n=1237
#create morphometric matrix
nestlMorph.mat <- as.matrix(nestlMorph.ne[,-c(1:10,22)])
#run tSNE
nestlMorph.tsne <- Rtsne(nestlMorph.mat)
df <- tibble(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
library(tidyverse) #ggplot2, dplyr, tibble, etc.
library(knitr)
library(ggfortify)
library(Rtsne)
library(usethis) #git integration
library(glmmTMB)
library(lme4)
library(ggpubr) #ggarrange() figure wraps
library(plyr)
library(ggeffects) #ggpredict
library(rstanarm) #stan models
library(shinystan) #stan model evaluation >launch_shinystan_demo()
library(loo) #loo() to compare fits between bayesian models
library(MuMIn) #dredge, model averaging
library(RColorBrewer) ; brewer.pal(n=8, name = "Dark2")#; display.brewer.pal(n = 8, name = "Dark2")
theme_set(theme_classic())
df <- tibble(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
df$indivCounts <- as.numeric(ave(df$id, df$id, FUN = length))
#sorted by ascending year and lifeStage (add sorting conditions with: ', variableName')
df <- df %>% arrange(year, lifeStage)
#make lifeStage a factor
df$lifeStage <- as.factor(df$lifeStage)
#check n for both life stages
length(df$lifeStage[df$lifeStage == "nestling"]) #4086 nestlings
length(df$lifeStage[df$lifeStage == "adult"]) #286 adults
#only individuals with multiple measurements (mm)
mm <- subset(df, df$indivCounts>1)
#only nestlings (ne)
ne <- subset(df, df$lifeStage == "nestling")
#only adults (ad)
ad <- subset(df, df$lifeStage == "adult")
#subset morphometric data from .ne
nestlMorph.ne <- ne[,c(1:23)] #n=4086
#drop NAs
nestlMorph.ne <- drop_na(nestlMorph.ne)#n=1413
#filter ages
nestlMorph.ne <- nestlMorph.ne %>% filter(between(age, 20, 30))#n=1237
#create morphometric matrix
nestlMorph.mat <- as.matrix(nestlMorph.ne[,-c(1:10,22)])
#run tSNE
nestlMorph.tsne <- Rtsne(nestlMorph.mat)
#create nestling bill morphometric dataframe
nestlBills.ne <- nestlMorph.ne[,15,18]
#create nestling bill morphometric dataframe
nestlBills.ne <- nestlMorph.ne[,c(15,18)]
autoplot(prcomp(nestlBills.ne), colour="sex")
autoplot(prcomp(nestlBills.ne))
autoplot(prcomp(nestlBills.ne), color=nestlMorph.ne$sexSummary)
autoplot(prcomp(nestlBills.ne), colour=nestlMorph.ne$sexSummary)
autoplot(prcomp(nestlBills.ne), colour=nestlMorph.ne$sexSummary)
prcomp(nestlBills.ne)
billPCA <- prcomp(nestlBills.ne)
billPCA$x
billPCA <- as.dataframe(prcomp(nestlBills.ne))
billPCA <- as.data.frame(prcomp(nestlBills.ne))
billPCA <- prcomp(nestlBills.ne)
View(billPCA)
billPCA$x[,1]
billPCA$x[,2]
billPCA$x
billPCA.plot <- data_frame(PC1=billPCA$x[,1],
PC2=billPCA$x[,2])
billPCA.plot <- tibble(PC1=billPCA$x[,1],
PC2=billPCA$x[,2])
View(billPCA.plot)
billPCA.plot <- tibble(PC1=billPCA$x[,1],
PC2=billPCA$x[,2],
sex=nestlMorph.ne$sexSummary)
billPCA$x
View(billPCA.plot)
billPCA.plot <- tibble(PC1=billPCA$x[,1],
PC2=billPCA$x[,2],
sex=nestlMorph.ne$sexSummary)
billPCA.plot %>%
ggplot(aes(x=PC1,y=PC2,color=sex))
billPCA.plot %>%
ggplot(aes(x=PC1,y=PC2))
billPCA.plot %>%
ggplot(aes(x=PC1,y=PC2,color=sex))
billPCA.plot %>%
ggplot(aes(x=PC1,y=PC2,color=sex))+
geom_point()
drop_na(billPCA.plot)
billPCA <- prcomp(nestlBills.ne)
billPCA.plot <- tibble(PC1=billPCA$x[,1],
PC2=billPCA$x[,2],
sex=nestlMorph.ne$sexSummary)
billPCA.plot %>%
ggplot(aes(x=PC1,y=PC2,color=sex))+
geom_point()
class(nestlMorph.ne$sexSummary)
as.factor(nestlMorph.ne$sexSummary)
levels(nestlMorph.ne$sexSummary)
class(nestlMorph.ne$sexSummary)
nestlMorph.ne$sexSummary <- as.factor(nestlMorph.ne$sexSummary)
class(nestlMorph.ne$sexSummary)
levels(nestlMorph.ne$sexSummary)
billPCA.plot <- tibble(PC1=billPCA$x[,1],
PC2=billPCA$x[,2],
sex=nestlMorph.ne$sexSummary)
class(billPCA.plot$sex)
billPCA.plot <- billPCA.plot[billPCA.plot$sex!=""]
levels(billPCA.plot$sex)
fct_explicit_na(billPCA.plot$sex, "")
replace_with_na()
install.packages("naniar")
library(naniar)
replace_with_na(replace = list(billPCA.plot$sex = ""))
replace_with_na(replace = list(billPCA.plot$sex, ""))
replace_with_na(replace = list(billPCA.plot$sex==""))
#create nestling bill morphometric dataframe
nestlBills.ne <- nestlMorph.ne[,c(15:18)]
library(tidyverse) #ggplot2, dplyr, tibble, etc.
library(knitr)
library(ggfortify)
library(Rtsne)
library(usethis) #git integration
library(glmmTMB)
library(lme4)
library(ggpubr) #ggarrange() figure wraps
library(plyr)
library(ggeffects) #ggpredict
library(rstanarm) #stan models
library(shinystan) #stan model evaluation >launch_shinystan_demo()
library(loo) #loo() to compare fits between bayesian models
library(MuMIn) #dredge, model averaging
library(RColorBrewer) ; brewer.pal(n=8, name = "Dark2")#; display.brewer.pal(n = 8, name = "Dark2")
theme_set(theme_classic())
df <- tibble(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
df$indivCounts <- as.numeric(ave(df$id, df$id, FUN = length))
#sorted by ascending year and lifeStage (add sorting conditions with: ', variableName')
df <- df %>% arrange(year, lifeStage)
#make lifeStage a factor
df$lifeStage <- as.factor(df$lifeStage)
#check n for both life stages
length(df$lifeStage[df$lifeStage == "nestling"]) #4086 nestlings
length(df$lifeStage[df$lifeStage == "adult"]) #286 adults
df$obs <- seq(1,length(df$nestlingMeasurementID))
View(df)
df$obs
df$sexSummary <- as.factor(df$sexSummary)
levels(df$sexSummary)
View(df)
df <- tibble(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
df$indivCounts <- as.numeric(ave(df$id, df$id, FUN = length))
#sorted by ascending year and lifeStage (add sorting conditions with: ', variableName')
df <- df %>% arrange(year, lifeStage)
#make lifeStage a factor
df$lifeStage <- as.factor(df$lifeStage)
#check n for both life stages
length(df$lifeStage[df$lifeStage == "nestling"]) #4086 nestlings
length(df$lifeStage[df$lifeStage == "adult"]) #286 adults
#create column with numbered observations for reference
df$obs <- seq(1,length(df$nestlingMeasurementID))
#make sex a factor
df$sexSummary <- as.factor(df$sexSummary)
levels(df$sexSummary)
df <- tibble(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
df$indivCounts <- as.numeric(ave(df$id, df$id, FUN = length))
#sorted by ascending year and lifeStage (add sorting conditions with: ', variableName')
df <- df %>% arrange(year, lifeStage)
#make lifeStage a factor
df$lifeStage <- as.factor(df$lifeStage)
#check n for both life stages
length(df$lifeStage[df$lifeStage == "nestling"]) #4086 nestlings
length(df$lifeStage[df$lifeStage == "adult"]) #286 adults
#create column with numbered observations for reference
df$obs <- seq(1,length(df$nestlingMeasurementID))
#make sex a factor
df$sexSummary <- as.factor(df$sexSummary)
levels(df$sexSummary)
#only individuals with multiple measurements (mm)
mm <- subset(df, df$indivCounts>1)
#only nestlings (ne)
ne <- subset(df, df$lifeStage == "nestling")
#only adults (ad)
ad <- subset(df, df$lifeStage == "adult")
#subset morphometric data from .ne
nestlMorph.ne <- ne[,c(1:23)] #n=4086
#drop NAs
nestlMorph.ne <- drop_na(nestlMorph.ne)#n=1413
nestlMorph.ne$sexSummary <- as.factor(nestlMorph.ne$sexSummary)
class(nestlMorph.ne$sexSummary)
levels(nestlMorph.ne$sexSummary)
#filter ages
nestlMorph.ne <- nestlMorph.ne %>% filter(between(age, 20, 30))#n=1237
#create nestling bill morphometric dataframe
nestlBills.ne <- nestlMorph.ne[,c(15:18)]
billPCA <- prcomp(nestlBills.ne)
billPCA.plot <- tibble(PC1=billPCA$x[,1],
PC2=billPCA$x[,2],
sex=nestlMorph.ne$sexSummary)
levels(billPCA.plot$sex)
billPCA.plot <- billPCA.plot[billPCA.plot$sex!=""]
billPCA <- prcomp(nestlBills.ne)
billPCA.plot <- tibble(PC1=billPCA$x[,1],
PC2=billPCA$x[,2],
sex=nestlMorph.ne$sexSummary)
levels(billPCA.plot$sex)
billPCA.plot %>%
ggplot(aes(x=PC1,y=PC2,color=sex))+
geom_point()
View(nestlBills.ne)
billPCA <- prcomp(nestlBills.ne)
billPCA.plot <- tibble(PC1=billPCA$x[,1],
PC2=billPCA$x[,2],
sex=nestlMorph.ne$sexSummary)
levels(billPCA.plot$sex)
billPCA.plot %>%
ggplot(aes(x=PC1,y=PC2,color=sex))+
geom_point()
View(nestlMorph.ne)
summary(billPCA)
billPCA
billPCA <- prcomp(nestlBills.ne)
summary(billPCA)
billPCA
billPCA.plot <- tibble(PC1=billPCA$x[,1],
PC2=billPCA$x[,2],
sex=nestlMorph.ne$sexSummary)
levels(billPCA.plot$sex)
billPCA.plot %>%
ggplot(aes(x=PC1,y=PC2,color=sex))+
geom_point()
nestlMorph.ne %>%
ggplot(aes(x=sexSummary,y=billNT))+
geom_boxplot()
t.test(nestlMorph.ne$billNT[nestlMorph.ne$sexSummary=="M"], nestlMorph.ne$billNT[nestlMorph.ne$sexSummary=="F"])
nestlMorph.ne %>%
ggplot(aes(x=sexSummary,y=billW))+
geom_boxplot()
t.test(nestlMorph.ne$billW[nestlMorph.ne$sexSummary=="M"], nestlMorph.ne$billW[nestlMorph.ne$sexSummary=="F"])
nestlMorph.ne %>%
ggplot(aes(x=sexSummary,y=billD))+
geom_boxplot()
t.test(nestlMorph.ne$billD[nestlMorph.ne$sexSummary=="M"], nestlMorph.ne$billD[nestlMorph.ne$sexSummary=="F"])
nestlMorph.ne %>%
ggplot(aes(x=sexSummary,y=TEC))+
geom_boxplot()
t.test(nestlMorph.ne$TEC[nestlMorph.ne$sexSummary=="M"], nestlMorph.ne$TEC[nestlMorph.ne$sexSummary=="F"])
summary(df[,c(2:23)])
df %>%
ggplot(aes(x=lifeStage,y=tarsus,color=sexSummary))+
geom_boxplot()
df %>%
ggplot(aes(x=lifeStage,y=billW,color=sexSummary))+
geom_boxplot()
df %>%
ggplot(aes(x=lifeStage,y=billD,color=sexSummary))+
geom_boxplot()
df %>%
ggplot(aes(x=lifeStage,y=billNT,color=sexSummary))+
geom_boxplot()
t.test(df$tarsus[nestlMorph.ne$lifeStage=="nestling"], df$tarsus[nestlMorph.ne$lifeStage=="adult"])
library(tidyverse) #ggplot2, dplyr, tibble, etc.
library(knitr)
library(ggfortify)
library(Rtsne)
library(usethis) #git integration
library(glmmTMB)
library(lme4)
library(ggpubr) #ggarrange() figure wraps
library(plyr)
library(ggeffects) #ggpredict
library(rstanarm) #stan models
library(shinystan) #stan model evaluation >launch_shinystan_demo()
library(loo) #loo() to compare fits between bayesian models
library(MuMIn) #dredge, model averaging
library(RColorBrewer) ; brewer.pal(n=8, name = "Dark2")#; display.brewer.pal(n = 8, name = "Dark2")
theme_set(theme_classic())
library(tidyverse) #ggplot2, dplyr, tibble, etc.
library(knitr)
library(ggfortify)
library(Rtsne)
library(usethis) #git integration
library(glmmTMB)
library(lme4)
library(ggpubr) #ggarrange() figure wraps
library(plyr)
library(ggeffects) #ggpredict
library(rstanarm) #stan models
library(shinystan) #stan model evaluation >launch_shinystan_demo()
library(loo) #loo() to compare fits between bayesian models
library(MuMIn) #dredge, model averaging
library(RColorBrewer) ; brewer.pal(n=8, name = "Dark2")#; display.brewer.pal(n = 8, name = "Dark2")
theme_set(theme_classic())
df <- tibble(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
summary(df[,c(2:23)])
df <- tibble(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
#summary(df[,c(2:23)])
bin1 <- 1:10
summary(df[,c(2:23)])
df %>% hist(calcAge)
df %>% plot(calcAge)
df %>% hist(calcAge)
hist(df$calcAge)
hist(df$calcAge[df$calcAge<1000])
hist(df$calcAge[df$calcAge<100])
hist(df$calcAge[df$calcAge>100])
hist(df$calcAge[df$calcAge>100 & df$calcAge<5000])
hist(df$calcAge[df$calcAge<60])
hist(df$calcAge[df$calcAge<70])
hist(df$calcAge[df$calcAge<80])
hist(df$calcAge[df$calcAge<90])
hist(df$calcAge[df$calcAge<100])
hist(df$calcAge[df$calcAge<40])
bin1 <- 1:10
bin2 <- 11:20
bin3 <- 21:30
bin4 <- 31:40
bin5 <- 40:60
bin6 <- 60:100
bin7 <- 100:1000
dim(df)
dim(df)[1]
print("bin1")
df %>% for (i in 1:dim(df)[1]) {
if(between(calcAge,1,10))
print("bin1")
}
else(print("no"))
df$ageBins <- for (i in 1:dim(df)[1]) {
if(between(df$calcAge,1,10))
print("bin1")
else(print("no"))
}
df$ageBins <- for (i in 1:dim(df)[1]) {
if(between(df$calcAge,1,10))
print("bin1"))
print("bin1")
df$ageBins <- for (i in 1:dim(df)[1]) {
if(between(df$calcAge,1,10))
print("bin1")
}
if(df$calcAge=1:10)
if(df$calcAge==1:10)
df$ageBins <- for (i in 1:dim(df)[1]) {
if(df$calcAge==1:10)
print("bin1")
}
df$ageBins <- for (i in 1:dim(df)[1]) {
if(df$calcAge>0 & df$calcAge<11)
print("bin1")
else {print("no")}
}
for (i in 1:dim(df)[1]) {
if(df$calcAge>0 & df$calcAge<11)
print("bin1")
else {print("no")}
}
b <- c(-Inf,10,20,30,40,60,100,1000,Inf)
bins <- c("bin1","bin2","bin3","bin4", "bin5","bin6","bin7","bin8")
df$ageBins <- cut(df$calcAge,breaks = b,labels = bins)
cbind(df$calcAge,df$ageBins)
View(df)
View(ne)
View(df)
b <- c(-Inf,10,20,30,40,60,100,1000,Inf)
bins <- c("bin1","bin2","bin3","bin4", "bin5","bin6","bin7","bin8")
df$ageBins <- cut(df$calcAge,breaks = b,labels = bins)
as.factor(df$ageBins)
df %>%
ggplot(aes(x=ageBins,y=billW),color=sexSummary)+
geom_boxplot()
summary(df$sexSummary)
df$ageBins <- as.factor(df$ageBins)
df$sexSummary <- as.factor(df$sexSummary)
df %>%
ggplot(aes(x=ageBins,y=billW),color=sexSummary)+
geom_boxplot()
df %>%
ggplot(aes(x=ageBins,y=billW),group=sexSummary)+
geom_boxplot()
levels(sexSummary)
levels(df$sexSummary)
df %>%
ggplot(aes(x=ageBins,y=billW),color=sexSummary)+
geom_boxplot()
df %>%
ggplot(aes(x=ageBins,y=billD),color=sexSummary)+
geom_boxplot()
df %>%
ggplot(aes(x=ageBins,y=billD))+
geom_boxplot(color=sexSummary)
df %>%
ggplot(aes(x=ageBins,y=billD))+
geom_boxplot(color=df$sexSummary)
df %>%
ggplot(aes(x=ageBins,y=billD, fill=sexSummary))+
geom_boxplot()
#sorted by ascending year and lifeStage (add sorting conditions with: ', variableName')
df <- df %>% arrange(year, lifeStage)
df <- drop_na(df)
df %>%
ggplot(aes(x=ageBins,y=billD, fill=sexSummary))+
geom_boxplot()
df %>%
ggplot(aes(x=ageBins,y=billD, fill=sexSummary))+
geom_boxplot()
df %>%
ggplot(aes(x=ageBins,y=billD, fill=sexSummary))+
geom_boxplot()
df <- tibble(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
summary(df[,c(2:23)])
df <- data.frame(read.csv("Nestlings1989-2018_no2011_WITH_AdultMeasurements_2001-2015.csv", h=T))
summary(df[,c(2:23)])
df %>% hist(calcAge)
hist(df$calcAge[df$calcAge<100])
hist(df$calcAge[df$calcAge>100 & df$calcAge<5000])
hist(df$calcAge[df$calcAge<40])
b <- c(-Inf,10,20,30,40,60,100,1000,Inf) #define breaks
bins <- c("bin1","bin2","bin3","bin4", "bin5","bin6","bin7","bin8") #label bins
df$ageBins <- cut(df$calcAge,breaks = b,labels = bins) #vectorize
df$ageBins <- as.factor(df$ageBins)
df$sexSummary <- as.factor(df$sexSummary)
levels(df$sexSummary)
df %>%
ggplot(aes(x=ageBins,y=billD, fill=sexSummary))+
geom_boxplot()
df %>%
drop_na(sexSummary,ageBins) %>%
ggplot(aes(x=ageBins,y=billD, fill=sexSummary))+
geom_boxplot()
```{r warning=FALSE}
df %>%
drop_na(sexSummary,ageBins) %>%
ggplot(aes(x=ageBins,y=billD, fill=sexSummary))+
geom_boxplot()
