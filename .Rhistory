library(plotly)
library(MuMIn) #dredge() for unsupervised model selection
library(AICcmodavg) #aictab() for AICc model comparisons
library(DHARMa)
library(DescTools)
theme_set(theme_classic())
```{r dataframe}
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)
View(df)
print(df[df$ID=="FFW-S DRIN02"])
print(df[df$ID=="FFW-S DRIN02"],)
df[df$ID=="FFW-S DRIN02"],)
df$ID[df$ID=="FFW-S DRIN02"]
df %>% filter(ID=="FFW-S DRIN02")
df$ID[df$ID=="FFW-S DRIN02"]
df %>% filter(ID=="FFW-S DRIN02")
df <- df %>% filter(ID=="FFW-S DRIN02")
df <- df %>% filter(!ID=="FFW-S DRIN02")
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)
df$ID[df$ID=="FFW-S DRIN02"]
df <- df %>% filter(!ID=="FFW-S DRIN02")
df$ID[df$ID=="FFW-S DRIN02"]
df %>% group_by(ID) %>% filter(n()>1)
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
View(duplicates.df)
duplicates.df <- sort(Name)
duplicates.df <- group_by(Name)
duplicates.df <- duplicates.df %>% group_by(Name)
View(duplicates.df)
write.csv(duplicates.df, "DuplicateNestlings.csv")
duplicates.df %>% arrange(CalcAge) %>% dplyr::distinct(ID, .keep_all = TRUE)
View(duplicates.df)
duplicates.df <- duplicates.df %>% arrange(CalcAge) %>% dplyr::distinct(Name, .keep_all = TRUE)
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
duplicates.df <- duplicates.df %>% group_by(Year) %>%  arrange(CalcAge) %>% dplyr::distinct(Name, .keep_all = TRUE)
View(duplicates.df)
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
duplicates.df <- duplicates.df %>%  arrange(Year, CalcAge) %>% dplyr::distinct(Name, .keep_all = TRUE)
View(duplicates.df)
df$ID[df$ID=="FFW-S DRIN02"]
df$ID[df$ID=="RFA-S	ALOT02"]
df$ID[df$ID=="5	STAD96"]
remove(d.frm)
remove(tab)
remove(r.mi)
remove(x)
remove(y)
df$ID[df$ID=="Y-5	ROTA98"]
df$ID[df$ID=="B3	WINK98"]
df$ID[df$ID=="B-1	WINK98"]
df$ID[df$ID=="GL 	JSUP05"]
df$ID[df$ID=="CV	WKAY05"]
df$ID[df$ID=="YB-OSW 	HORC10"]
View(df)
View(duplicates.df)
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)
df$ID[df$ID=="YB-OSW 	HORC10"]#not in df
df$ID[df$ID=="FE WCRI18"]
df$ID[df$ID=="YB-OSW HORC10"]#not in df
df$ID[df$ID=="CV WKAY05"]#not in df
df$ID[df$ID=="GL JSUP05"]#not in df
df$ID[df$ID=="B3 WINK98"]#not in df
df$ID[df$ID=="Y-5 ROTA98"]#not in df
df$ID[df$ID=="B3 WINK98"]#in df
df$ID[df$ID=="B-1	WINK98"]#not in df
df$ID[df$ID=="GL JSUP05"]#not in df
df$ID[df$ID=="CV WKAY05"]#not in df
df$ID[df$ID=="YB-OSW HORC10"]#not in df
df$ID[df$ID=="FE WCRI18"]
df$ID[df$ID=="Y-5	ROTA98"]
df$ID[df$ID=="Q4 CARE11"]
#Remove nestlings identified by Anne (runts/or suspect measurements)
df$ID[df$ID=="FFW-S DRIN02"]#in df, remove below
df$ID[df$ID=="RFA-S	ALOT02"]#not in df
df$ID[df$ID=="5	STAD96"]#not in df
df$ID[df$ID=="Y-5 ROTA98"]#not in df
df$ID[df$ID=="B3 WINK98"]#in df, remove below
df$ID[df$ID=="B-1	WINK98"]#not in df
df$ID[df$ID=="GL JSUP05"]#in df, remove below
df$ID[df$ID=="CV WKAY05"]#not in df
df$ID[df$ID=="YB-OSW HORC10"]#not in df
df$ID[df$ID=="FE WCRI18"]#in df, remove below
df$ID[df$ID=="Q4 CARE11"]#in df, remove below
df$ID[df$ID=="OD CCPL02"]
df$ID[df$ID=="*00 WCRI14"]
df$ID[df$ID=="00 WCRI14"]
df$ID[df$ID=="JC NDYC17"]
df$ID[df$ID=="Dead under nest	MIPA14"]
df$ID[df$ID=="L2 KRUM93"]
df$ID[df$ID=="L-2 KRUM93"]
df$ID[df$ID=="orange SWEG91"]
df$ID[df$ID=="SWB-W BURP03"]
df$ID[df$ID=="3 PINW00"]
df$ID[df$ID=="4 PINW00"]#in, remove below
df$ID[df$ID=="DOA RGBY00"]
df$ID[df$ID=="doa SEPG04"]
df$ID[df$ID=="2-r HORC04"]
df$ID[df$ID=="doa CLAR05"]
df$ID[df$ID=="doa HOMC05"]
df$ID[df$ID=="doa JUDD06"]
df$ID[df$ID=="doa1 KAYS06"]
df$ID[df$ID=="doa2 KAYS06"]
df$ID[df$ID=="doa3 KAYS06"]
df$ID[df$ID=="doa1 BROT07"]
df$ID[df$ID=="doa2 BROT07"]
df$ID[df$ID=="doa1 NMUR07"]#in, remove below
df$ID[df$ID=="doa2 NMUR07"]#in, remove below
df$ID[df$ID=="doa3 NMUR07"]#in, remove below
df$ID[df$ID=="doa4 NMUR07"]#in, remove below
df$ID[df$ID=="doa5 NMUR07"]#in, remove below
df <- df %>% filter(!ID==c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17",
"L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00",
"doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06",
"doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07",
"doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07"))
df <- df %>% filter(!ID==c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17",
"L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00",
"doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06",
"doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07",
"doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07"))
df <- df %>% filter(!ID=="FFW-S DRIN02"|"B3 WINK98"|"GL JSUP05"|"Q4 CARE11"|"JC NDYC17"|
"L-2 KRUM93"|"orange SWEG91"|"SWB-W BURP03"|"3 PINW00"|"4 PINW00"|
"doa SEPG04"|"2-r HORC04"|"doa CLAR05"|"doa HOMC05"|"doa JUDD06"|
"doa1 KAYS06"|"doa2 KAYS06"|"doa3 KAYS06"|"doa1 BROT07"|"doa2 BROT07"|
"doa1 NMUR07"|"doa2 NMUR07"|"doa3 NMUR07"|"doa4 NMUR07"|"doa5 NMUR07")
df <- df %>% filter(!ID=="FFW-S DRIN02","B3 WINK98")
df <- df %>% filter(!ID==c("FFW-S DRIN02","B3 WINK98"))
#Remove nestlings identified by Anne (runts/or suspect measurements)
#file name: Runt Nestlings so-called by year
df$ID[df$ID=="FFW-S DRIN02"]#in, remove below
df$ID[df$ID=="B3 WINK98"]#in, remove below
df <- df %>% filter(!ID==c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17",
"L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00",
"doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06",
"doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07",
"doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07"))
df <- df %>% filter(!ID==c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17"))
df$ID[df$ID=="GL JSUP05"]#in, remove below
df$ID[df$ID=="Q4 CARE11"]#in, remove below
runtIds <- c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17",
"L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00",
"doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06",
"doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07",
"doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07")
df <- df %>% filter(!ID==runtIds)
runtIds <- list(c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17",
"L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00",
"doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06",
"doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07",
"doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07"))
View(runtIds)
remove(runtIds)
df <- df %>% filter(!ID== %in% c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17",
df <- df %>% filter(!ID %in% c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17",
"L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00",
"doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06",
"doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07",
"doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07"))
#Remove nestlings identified by Anne (runts/or suspect measurements)
#file name: Runt Nestlings so-called by year
df$ID[df$ID=="FFW-S DRIN02"]#in, remove below
df$ID[df$ID=="RFA-S	ALOT02"]#not in
df$ID[df$ID=="5	STAD96"]#not in
df$ID[df$ID=="Y-5 ROTA98"]#not in
df$ID[df$ID=="B3 WINK98"]#in, remove below
df$ID[df$ID=="B-1	WINK98"]#not in
df$ID[df$ID=="GL JSUP05"]#in, remove below
df$ID[df$ID=="CV WKAY05"]#not in
df$ID[df$ID=="YB-OSW HORC10"]#not in
df$ID[df$ID=="FE WCRI18"]#in, remove below
df$ID[df$ID=="Q4 CARE11"]#in, remove below
#Remove individuals listed above
df <- df %>% filter(!ID %in% c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17","L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00","doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06","doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07","doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07","FE WCRI18"))
df$ID[df$ID=="FE WCRI18"]#in, remove below
df$ID[df$ID=="Q4 CARE11"]#in, remove below
df$ID[df$ID=="OD CCPL02"]#not in
df$ID[df$ID=="*00 WCRI14"]#not in
df$ID[df$ID=="JC NDYC17"]#in, remove below
df$ID[df$ID=="Dead under nest	MIPA14"]#not in
df$ID[df$ID=="L-2 KRUM93"]#in, remove below
df$ID[df$ID=="orange SWEG91"]#in, remove below
df$ID[df$ID=="SWB-W BURP03"]#in, remove below
df$ID[df$ID=="3 PINW00"]#in, remove below
df$ID[df$ID=="4 PINW00"]#in, remove below
df$ID[df$ID=="DOA RGBY00"]#in, remove below
#Remove individuals listed above
df <- df %>% filter(!ID %in% c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17","L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00","doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06","doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07","doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07","FE WCRI18","DOA RGBY00"))
df$ID[df$ID=="DOA RGBY00"]#in, remove below
df$ID[df$ID=="doa SEPG04"]#in, remove below
df$ID[df$ID=="2-r HORC04"]#in, remove below
df$ID[df$ID=="doa CLAR05"]#in, remove below
df$ID[df$ID=="doa HOMC05"]#in, remove below
df$ID[df$ID=="doa JUDD06"]#in, remove below
df$ID[df$ID=="doa1 KAYS06"]#in, remove below
df$ID[df$ID=="doa2 KAYS06"]#in, remove below
df$ID[df$ID=="doa3 KAYS06"]#in, remove below
df$ID[df$ID=="doa1 BROT07"]#in, remove below
df$ID[df$ID=="doa2 BROT07"]#in, remove below
df$ID[df$ID=="doa1 NMUR07"]#in, remove below
df$ID[df$ID=="doa2 NMUR07"]#in, remove below
df$ID[df$ID=="doa3 NMUR07"]#in, remove below
df$ID[df$ID=="doa4 NMUR07"]#in, remove below
df$ID[df$ID=="doa5 NMUR07"]#in, remove below
df$ID[df$ID=="doa5 NMUR07"]
df$ID[df$ID=="X0 YFER00"]
#Remove individuals listed above
df <- df %>% filter(!ID %in% c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17","L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00","doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06","doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07","doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07","FE WCRI18","DOA RGBY00","X0 YFER00"))
#Deleting SPEG04 per Anne's request
df <- df %>% filter(!NestName=="SEPG04")
View(duplicates.df)
View(duplicates.df)
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
View(duplicates.df)
View(duplicates.df)
#Keeping second measurement for GYMN08 per Anne's request
duplicates.df <- duplicates.df[!(df$NestName=="GYMN08" & df$BandDateJul==126)]
#Keeping second measurement for GYMN08 per Anne's request
duplicates.df <- duplicates.df %>% filter(!NestName=="GYMN08" & BandDateJul=="126")
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#Keeping second measurement for GYMN08 per Anne's request
duplicates.df <- subset(duplicates.df, !NestName=="GYMN08" & BandDateJul=="126")
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#Keeping second measurement for GYMN08 per Anne's request
duplicates.df <- subset(duplicates.df, NestName!="GYMN08" & BandDateJul!="126")
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#Keeping second measurement for GYMN08 per Anne's request
duplicates.df <- subset(duplicates.df, NestName!="GYMN08" | BandDateJul!="126")
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)
#Remove nestlings identified by Anne (runts/or suspect measurements)
#file name: Runt Nestlings so-called by year
df$ID[df$ID=="FFW-S DRIN02"]#in, remove below
df$ID[df$ID=="RFA-S	ALOT02"]#not in
df$ID[df$ID=="5	STAD96"]#not in
df$ID[df$ID=="Y-5 ROTA98"]#not in
df$ID[df$ID=="B3 WINK98"]#in, remove below
df$ID[df$ID=="B-1	WINK98"]#not in
df$ID[df$ID=="GL JSUP05"]#in, remove below
df$ID[df$ID=="CV WKAY05"]#not in
df$ID[df$ID=="YB-OSW HORC10"]#not in
df$ID[df$ID=="FE WCRI18"]#in, remove below
df$ID[df$ID=="Q4 CARE11"]#in, remove below
df$ID[df$ID=="OD CCPL02"]#not in
df$ID[df$ID=="*00 WCRI14"]#not in
df$ID[df$ID=="JC NDYC17"]#in, remove below
df$ID[df$ID=="Dead under nest	MIPA14"]#not in
df$ID[df$ID=="L-2 KRUM93"]#in, remove below
df$ID[df$ID=="orange SWEG91"]#in, remove below
df$ID[df$ID=="SWB-W BURP03"]#in, remove below
df$ID[df$ID=="3 PINW00"]#in, remove below
df$ID[df$ID=="4 PINW00"]#in, remove below
df$ID[df$ID=="DOA RGBY00"]#in, remove below
df$ID[df$ID=="doa SEPG04"]#in, remove below
df$ID[df$ID=="2-r HORC04"]#in, remove below
df$ID[df$ID=="doa CLAR05"]#in, remove below
df$ID[df$ID=="doa HOMC05"]#in, remove below
df$ID[df$ID=="doa JUDD06"]#in, remove below
df$ID[df$ID=="doa1 KAYS06"]#in, remove below
df$ID[df$ID=="doa2 KAYS06"]#in, remove below
df$ID[df$ID=="doa1 BROT07"]#in, remove below
df$ID[df$ID=="doa2 BROT07"]#in, remove below
df$ID[df$ID=="doa1 NMUR07"]#in, remove below
df$ID[df$ID=="doa2 NMUR07"]#in, remove below
df$ID[df$ID=="doa3 NMUR07"]#in, remove below
df$ID[df$ID=="doa4 NMUR07"]#in, remove below
df$ID[df$ID=="doa5 NMUR07"]#in, remove below
df$ID[df$ID=="X0 YFER00"]#identified in DuplicateNestlings file, remove below (*2 obs)
#Remove 29 individuals listed above
df <- df %>% filter(!ID %in% c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17","L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00","doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06","doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07","doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07","FE WCRI18","DOA RGBY00","X0 YFER00"))#(new n=2370)
#Deleting SPEG04 per Anne's request
df <- df %>% filter(!NestName=="SEPG04")#4 nestlings (new n=2366)
#Keeping second measurement for GYMN08 per Anne's request
duplicates.df <- subset(duplicates.df, NestName!="GYMN08" | BandDateJul!="126")
#Keeping second measurement for GYMN08 per Anne's request
df <- subset(df, NestName!="GYMN08" | BandDateJul!="126")
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#Sort remaining duplicates.df by year and CalcAge and only retain the first (youngest) observation
df <- df %>%  arrange(Year,NestName, CalcAge) %>% dplyr::distinct(Name, .keep_all = TRUE)
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)#n=2394 nestlings
#Remove 29 individuals listed above
df <- df %>% filter(!ID %in% c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17","L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00","doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06","doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07","doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07","FE WCRI18","DOA RGBY00","X0 YFER00"))#new n=2365
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#Deleting SPEG04 per Anne's request
df <- df %>% filter(!NestName=="SEPG04")#4 nestlings (new n=2361)
#Keeping second measurement for GYMN08 per Anne's request
df <- subset(df, NestName!="GYMN08" | BandDateJul!="126")#new n=2359
#Sort remaining duplicates.df by year and CalcAge and only retain the first (youngest) observation
duplicates.df <- duplicates.df %>%  arrange(NestName, CalcAge) %>% dplyr::distinct(Name, .keep_all = TRUE)
#Sort remaining duplicates.df by year and CalcAge and only retain the first (youngest) observation
duplicates.df <- duplicates.df %>%  arrange(ID, CalcAge) %>% dplyr::distinct(Name, .keep_all = TRUE)
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#Sort remaining duplicates.df by year and CalcAge and only retain the first (youngest) observation
duplicates.df <- duplicates.df %>%  arrange(ID, CalcAge) %>% dplyr::distinct(Name, .keep_all = TRUE)
#Sort remaining duplicates.df by year and CalcAge and only retain the first (youngest) observation
df <- df %>%  arrange(ID, CalcAge) %>% dplyr::distinct(Name, .keep_all = TRUE)
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)#n=2394 nestlings
#Remove 29 individuals listed above
df <- df %>% filter(!ID %in% c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17","L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00","doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06","doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07","doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07","FE WCRI18","DOA RGBY00","X0 YFER00"))#new n=2365
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#Deleting SPEG04 per Anne's request
df <- df %>% filter(!NestName=="SEPG04")#4 nestlings (new n=2361)
#Keeping second measurement for GYMN08 per Anne's request
df <- subset(df, NestName!="GYMN08" | BandDateJul!="126")#new n=2359
#Sort remaining duplicates.df by year and CalcAge and only retain the first (youngest) observation
df <- df %>%  group_by(Year) %>% arrange(NestName, CalcAge) %>% dplyr::distinct(Name, .keep_all = TRUE)
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)#n=2394 nestlings
#Remove 29 individuals listed above
df <- df %>% filter(!ID %in% c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17","L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00","doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06","doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07","doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07","FE WCRI18","DOA RGBY00","X0 YFER00"))#new n=2365
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#Deleting SPEG04 per Anne's request
df <- df %>% filter(!NestName=="SEPG04")#4 nestlings (new n=2361)
#Keeping second measurement for GYMN08 per Anne's request
df <- subset(df, NestName!="GYMN08" | BandDateJul!="126")#new n=2359
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#Sort remaining duplicates.df by year and CalcAge and only retain the first (youngest) observation
duplicates.df <- duplicates.df %>%  group_by(Year) %>% arrange(NestName, CalcAge) %>% dplyr::distinct(Name, .keep_all = TRUE)
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#Sort remaining duplicates.df by year and CalcAge and only retain the first (youngest) observation
duplicates.df <- duplicates.df %>%  group_by(Year) %>% arrange(NestName, CalcAge) %>% dplyr::distinct(ID, .keep_all = TRUE)
df1 <- df %>%  group_by(Year) %>% arrange(NestName, CalcAge) %>% dplyr::distinct(ID, .keep_all = TRUE)
remove(df1)
df <- df %>%  group_by(Year) %>% arrange(NestName, CalcAge) %>% dplyr::distinct(ID, .keep_all = TRUE)
df %>% group_by(ID) %>% filter(n()>1)
duplicated(df)
duplicated(df$ID)
summary(duplicated(df$ID))
#Select variables
df <- df %>%
select(Year,Name,NestName,ID,AgeField,CalcAge,HatchDateJul,HatchDateJulYear,AllSex,BillNT,BillWidth,BillDepth,TEC,Head,UpperBill,UBillSurface,TotBillSurface,Skull,Tarsus,Weight)
#Rename variables
df <- df %>%
rename(FieldAge=AgeField,BNT=BillNT,BW=BillWidth,BD=BillDepth,UB=UpperBill,UBS=UBillSurface,TBS=TotBillSurface)
#Count NAs
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
#Remove NAs
df <- df %>%
filter_at(vars(Weight,HatchDateJul,BD,Tarsus,Skull,BW), all_vars(!is.na(.)))
countNAs
#Remove NAs
df <- df %>%
filter_at(vars(Weight,HatchDateJul,BD,Tarsus,Skull,BW), all_vars(!is.na(.)))#new n=2323
#Recount NAs
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
which(is.na(df$Name), arr.ind=TRUE)
df$Name %>% replace_na('NA')
which(is.na(df$Name), arr.ind=TRUE)
df$name <- df$Name %>% replace_na("NA")
countNAs#still 3 NAs in name for nestlings named "NA"
which(is.na(df$Name), arr.ind=TRUE)
df$name <- df$Name %>% replace_na("N-A")
which(is.na(df$Name), arr.ind=TRUE)
countNAs#still 3 NAs in name for nestlings named "NA"
df$Name %>% replace_na("N-A")
which(is.na(df$Name), arr.ind=TRUE)
df$Name[c(587,1009,1364),]<- "N-A"
df$Name %>% replace_na(list("N-A"))
df <- df %>%
mutate(Name = coalesce(Name, "N_A"))
which(is.na(df$Name), arr.ind=TRUE)
df <- df %>%
mutate(Name = coalesce(Name, "NA"))
print(my_dataframe2)
countNAs#still 3 NAs in name for nestlings named "NA"
which(is.na(df$Name), arr.ind=TRUE)
df <- df %>%
mutate(Name = coalesce(Name, "NA"))
#Recount NAs
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs#still 3 NAs in name for nestlings named "NA"
#filter out Weights < 160
df <- df %>% filter(Weight > 160)
range(df$Weight)
range(df$CalcAge)
df <- df %>% filter(between(Age, 24,30))
df <- df %>% filter(between(CalcAge, 24,30))
range(df$CalcAge)
View(df)
#resort df
df <- df %>% arrange(Year,NestName,ID)
df <- df[,1:20]
View(df)
write.csv(df, "CrowNestlingClimate_AllNestlingsCleaned.csv")
library(tidyverse)
library(dplyr)
library(broom) #tidy() to create tibbles from model summaries
library(car) #vif
library(cowplot)
library(lme4) #frequentist models
library(sjPlot) #plot_model & tab_model (blue = #377EB8)
library(ggpubr) #ggarrange
library(glmmTMB) #zi & overdispersed models
library(lmerTest) #lmerTest::step
library(ggeffects) #ggpredict
#PACKAGES FOR BAYESIAN MODELS
library(rstanarm) #stan models
library(shinystan) #stan model evaluation
#launch_shinystan_demo()
library(loo) #use loo() to compare fits between bayesian models
library(plotly)
library(MuMIn) #dredge() for unsupervised model selection
library(AICcmodavg) #aictab() for AICc model comparisons
library(DHARMa)
library(DescTools)
theme_set(theme_classic())
df <- read.csv("CrowNestlingClimate.csv", h=TRUE)#n=2394 nestlings
#Remove nestlings identified by Anne (runts/or suspect measurements)
#file name: Runt Nestlings so-called by year
df$ID[df$ID=="FFW-S DRIN02"]#in, remove below
df$ID[df$ID=="RFA-S	ALOT02"]#not in
df$ID[df$ID=="5	STAD96"]#not in
df$ID[df$ID=="Y-5 ROTA98"]#not in
df$ID[df$ID=="B3 WINK98"]#in, remove below
df$ID[df$ID=="B-1	WINK98"]#not in
df$ID[df$ID=="GL JSUP05"]#in, remove below
df$ID[df$ID=="CV WKAY05"]#not in
df$ID[df$ID=="YB-OSW HORC10"]#not in
df$ID[df$ID=="FE WCRI18"]#in, remove below
df$ID[df$ID=="Q4 CARE11"]#in, remove below
df$ID[df$ID=="OD CCPL02"]#not in
df$ID[df$ID=="*00 WCRI14"]#not in
df$ID[df$ID=="JC NDYC17"]#in, remove below
df$ID[df$ID=="Dead under nest	MIPA14"]#not in
df$ID[df$ID=="L-2 KRUM93"]#in, remove below
df$ID[df$ID=="orange SWEG91"]#in, remove below
df$ID[df$ID=="SWB-W BURP03"]#in, remove below
df$ID[df$ID=="3 PINW00"]#in, remove below
df$ID[df$ID=="4 PINW00"]#in, remove below
df$ID[df$ID=="DOA RGBY00"]#in, remove below
df$ID[df$ID=="doa SEPG04"]#in, remove below
df$ID[df$ID=="2-r HORC04"]#in, remove below
df$ID[df$ID=="doa CLAR05"]#in, remove below
df$ID[df$ID=="doa HOMC05"]#in, remove below
df$ID[df$ID=="doa JUDD06"]#in, remove below
df$ID[df$ID=="doa1 KAYS06"]#in, remove below
df$ID[df$ID=="doa2 KAYS06"]#in, remove below
df$ID[df$ID=="doa3 KAYS06"]#in, remove below
df$ID[df$ID=="doa1 BROT07"]#in, remove below
df$ID[df$ID=="doa2 BROT07"]#in, remove below
df$ID[df$ID=="doa1 NMUR07"]#in, remove below
df$ID[df$ID=="doa2 NMUR07"]#in, remove below
df$ID[df$ID=="doa3 NMUR07"]#in, remove below
df$ID[df$ID=="doa4 NMUR07"]#in, remove below
df$ID[df$ID=="doa5 NMUR07"]#in, remove below
df$ID[df$ID=="X0 YFER00"]#identified in DuplicateNestlings file, remove below (*2 obs)
#Remove 29 individuals listed above
df <- df %>% filter(!ID %in% c("FFW-S DRIN02","B3 WINK98","GL JSUP05","Q4 CARE11","JC NDYC17","L-2 KRUM93","orange SWEG91","SWB-W BURP03","3 PINW00","4 PINW00","doa SEPG04","2-r HORC04","doa CLAR05","doa HOMC05","doa JUDD06","doa1 KAYS06","doa2 KAYS06","doa3 KAYS06","doa1 BROT07","doa2 BROT07","doa1 NMUR07","doa2 NMUR07","doa3 NMUR07","doa4 NMUR07","doa5 NMUR07","FE WCRI18","DOA RGBY00","X0 YFER00"))#new n=2365
#Find duplicate IDs
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#list of duplicates sent to Anne
#write.csv(duplicates.df, "DuplicateNestlings.csv")
#Deleting SPEG04 per Anne's request
df <- df %>% filter(!NestName=="SEPG04")#4 nestlings (new n=2361)
#Keeping second measurement for GYMN08 per Anne's request
df <- subset(df, NestName!="GYMN08" | BandDateJul!="126")#new n=2359
#Update duplicate IDs (new n=38)
duplicates.df <- df %>% group_by(ID) %>% filter(n()>1)
#Code check on duplicates.df: Sort remaining duplicates.df by year and CalcAge and only retain the first (youngest) observation
duplicates.df <- duplicates.df %>%  group_by(Year) %>% arrange(NestName, CalcAge) %>% dplyr::distinct(ID, .keep_all = TRUE)#new n=19
#Sort remaining duplicates.df by year and CalcAge and only retain the first (youngest) observation
df <- df %>%  group_by(Year) %>% arrange(NestName, CalcAge) %>% dplyr::distinct(ID, .keep_all = TRUE)#new n=2340 (19 fewer than above, so code works)
summary(duplicated(df$ID))#no more duplicates
#Select variables
df <- df %>%
select(Year,Name,NestName,ID,AgeField,CalcAge,HatchDateJul,HatchDateJulYear,AllSex,BillNT,BillWidth,BillDepth,TEC,Head,UpperBill,UBillSurface,TotBillSurface,Skull,Tarsus,Weight)
#Rename variables
df <- df %>%
rename(FieldAge=AgeField,BNT=BillNT,BW=BillWidth,BD=BillDepth,UB=UpperBill,UBS=UBillSurface,TBS=TotBillSurface)
#Count NAs
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs
#Remove NAs
df <- df %>%
filter_at(vars(Weight,HatchDateJul,BD,Tarsus,Skull,BW), all_vars(!is.na(.)))#new n=2323
#Recount NAs
countNAs <- sapply(df, function(x) sum(is.na(x)))
countNAs#still 3 NAs in name for nestlings named "NA"
#Change "NA" name to "N_A" so R doesn't cause problems
df <- df %>%
mutate(Name = coalesce(Name, "N_A"))
#filter out Weights < 160
df <- df %>% filter(Weight > 160)#new n=2313
range(df$Weight)
#filter between 24 and 30 days CalcAges
df <- df %>% filter(between(CalcAge, 24,30))#new n=2035
range(df$CalcAge)
#resort df
df <- df %>% arrange(Year,NestName,ID)
View(df)
Exp <- c(257,200,216,242,224,267,250,236,199,235)
PC <- c(201,196,227,218,231,231,180,225,272,194)
t.test(PC,Exp)
var(Exp)
#Experimental
Exp <- c(257,200,216,242,224,267,250,236,199,235)
#Positive control
PC <- c(201,196,227,218,231,231,180,225,272,194)
#t test
t.test(PC,Exp)
