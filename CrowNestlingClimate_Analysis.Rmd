---
title: "Nestling morphology responds to yearly fluctuations in temperature and precipitation"
author: "Justin Mann"
date: "2023-07-04"
output: html_document
---

```{r libraries, include=FALSE}
library(tidyverse)
library(broom) #tidy() to create tibbles from model summaries
library(car) #vif (variance inflation factor for measuring covariance)
library(cowplot)
library(lme4) #frequentist models  
library(sjPlot) #plot_model & tab_model (blue = #377EB8)
library(ggpubr) #ggarrange for plot wraps
library(lmerTest) #lmerTest::step
library(ggeffects) #ggpredict
#library(plotly) #ggplotly() to make interactive plots with scroll over ids
library(MuMIn) #dredge() for unsupervised model selection
library(AICcmodavg) #aictab() for AICc model comparisons
library(DHARMa) #model validation functions
library(DescTools) #Entropy() and MutInf()

#Libraries for Bayesian Models
library(rstanarm) #stan models
library(shinystan) #stan model evaluation
#launch_shinystan_demo()
library(loo) #use loo() to compare fits between bayesian models
library(broom.mixed) #rstanarm_tidiers() for tidying stan model summaries

theme_set(theme_classic()) #default plots with no gridlines
```

```{r colorblind accessible pallet}
colorBlindPal  <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
                       "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```

## Nestling Data

```{r nestling dataframe}
nestling.df <- read.csv("CrowNestlingClimate_MorphometricData.csv", h=TRUE)
#n=2040 nestlings

nestling.df$Sex[nestling.df$Sex == ''] <- NA #replace empty strings with NA
nestling.df <- nestling.df %>% replace_na(list(Sex = "U")) #replace NAs in Sex with "U" 

nestling.df$Sex <- as.factor(nestling.df$Sex) #coerce as factor
nestling.df <- nestling.df[,-26] #drop condition vector
nestling.df <- nestling.df %>% #move vectors, prep for scaling
  relocate(CalcAge, .after = CalcAgeInteger) %>% 
  relocate(HatchDateJulYear, .after = MeasurementDateJulYear) %>% 
  relocate(Sex, .after = ID)
```

```{r summarize nestling data}
summary(nestling.df)
```

## Climate Data

```{r climate dataframe}
climate.df <- read.csv("ClimateMetrics_ForJoining.csv", h=TRUE)
```

```{r summarize climate data}
summary(climate.df)
```

## Join Climate and Nestling Data

```{r join climate and nestling data}
df <- left_join(nestling.df,climate.df, by = "HatchDateJulYear")
df <- df %>% 
  rename(HatchDate=Date) %>% 
  relocate(HatchDate, .before = HatchDateJulYear)
```

## Exclusions

```{r last minute exclusions}
df <- df %>% filter(ID!="0 WCRI14") #Field error in TEC measurement
df <- df %>% filter(ID!="8V YEFE13") #Field error in TEC measurement
df <- df %>% filter(ID!="0D CCPL02") #Field error in TEC measurement
df <- df %>% filter(ID!="Q4 CARE11") #error in measurement
df <- df %>% filter(ID!="JC NDYC17") #error in measurement
df <- df %>% filter(ID!="L-2 KRUM93") #error in measurement
df <- df %>% filter(ID!="3 PINW00") #injured nestling, unreliable weight
df <- df %>% filter(ID!="DOA RGBY00") #partly predated
df <- df %>% filter(ID!="doa HOMC05") #error in weight measurement
df <- df %>% filter(ID!="doa JUDD06") #partly predated
df <- df %>% filter(ID!="doa1 BROT07") #error in measurement
```

## Data Scaling

### Normalize Continuous Data
Subtract each value from the mean (center) and divide it by the standard deviation

```{r scaling}
#categorical data  
categorical.df <- df[,1:11]

#continuous data
continuous.df <- df[,12:46]

#scale continuous data
#?scale()
scaled.mat <- scale(continuous.df, center = TRUE, scale = TRUE)

#join unscaled and scaled data
scaled.df <- cbind(categorical.df,scaled.mat)
```

## Data frames for males, females and unknown sex

```{r sexes data frames}
#Males scaled
M.scaled.df <- subset(scaled.df, Sex=="M")
#Males unscaled
M.df <- subset(df, Sex=="M")

#Females scaled
F.scaled.df <- subset(scaled.df, Sex=="F")
#Females unscaled
F.df <- subset(df, Sex=="F")

#Sex unknown scaled
U.scaled.df <- subset(scaled.df, Sex=="U")
#Sex unknown unscaled
U.df <- subset(df, Sex=="U")

#Both sexes scaled
B.scaled.df <- rbind(F.scaled.df,M.scaled.df)
#Both sexes unscaled
B.df <- rbind(F.df,M.df)
```

```{r write scaled and unscaled csv}
# write.csv(df, "CrowNestlingClimate_UnscaledData_7.8.23.csv", row.names = FALSE)
#write.csv(scaled.df, "CrowNestlingClimate_ScaledData_7.8.23.csv", row.names = FALSE)
```

## Weight by Age Plot

```{r WeightAge.plot}
WeightAge.plot <- ggplot(data = df, aes(x = CalcAge, y = Weight, color = Sex))+
  geom_jitter(width = 0.2, shape = 1, size = 1.8)+
  geom_smooth(method = "lm", aes(fill = Sex), alpha = 0.2)+
  scale_color_manual(name="Sex",
                    values=c("#E69F00","#56B4E9","#000000"),
                    labels=c("Female","Male","Unknown"))+
  scale_fill_manual(values = c("#E69F00","#56B4E9","#000000"), guide = "none")+
  ylab("Weight (g)")+
  xlab("Nestling age (days)")
WeightAge.plot
#cowplot::save_plot("Plots/WeightAge.plot.png", WeightAge.plot, base_height = 4, base_width = 7)
```


## Nestling Weight

### Weight by Minimum Temperature Plot

```{r WeightMinC.plot}
WeightMinC.plot <- ggplot(data = df, aes(x = MinC8_22, y = Weight, color = Sex))+
  geom_jitter(width = 0.2, shape = 1, size = 1.8)+
  geom_smooth(method="lm", aes(fill = Sex), alpha = 0.2)+
  scale_color_manual(name="Sex",
                    values=c("#E69F00","#56B4E9","#000000"),
                    labels=c("Female","Male","Unknown"))+
  scale_fill_manual(values = c("#E69F00","#56B4E9","#000000"), guide = "none")+
  ylab("Weight (g)")+
  xlab("Average minimum temperature (C)")+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_text(size = 14),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
WeightMinC.plot
#cowplot::save_plot("Plots/WeightMinC.plot.png", WeightMinC.plot, base_height = 4, base_width = 7)
```

### Male Weight Model

```{r M.Weight.mdl}
M.Weight.mdl <- lm(Weight ~ MinC8_22 * PrecipSum8_22, data = M.scaled.df)
summary(M.Weight.mdl)
```

### Female Weight Model

```{r F.Weight.mdl}
F.Weight.mdl <- lm(Weight ~ MinC8_22 * PrecipSum8_22, data = F.scaled.df)
summary(F.Weight.mdl)
```

### All Nestlings Weight Model

```{r A.Weight.mdl}
A.Weight.mdl <- lm(Weight ~ MinC8_22 * PrecipSum8_22, data = scaled.df)
summary(A.Weight.mdl)
```

### Dataframes for Weight Forest Plot

```{r Weight.dfs for fplot}
M.Weight.df <- tidy(M.Weight.mdl, quick = FALSE)
  ci <- as_tibble(confint(M.Weight.mdl))
  M.Weight.df$ci.lower <- ci$`2.5 %`
  M.Weight.df$ci.upper <- ci$`97.5 %`
  M.Weight.df$Dataset <- "Male"
  M.Weight.df$Metric <- "Weight"
  M.Weight.df <- M.Weight.df[-1,]

F.Weight.df <- tidy(F.Weight.mdl, quick = FALSE)
  ci <- as_tibble(confint(F.Weight.mdl))
  F.Weight.df$ci.lower <- ci$`2.5 %`
  F.Weight.df$ci.upper <- ci$`97.5 %`
  F.Weight.df$Dataset <- "Female"
  F.Weight.df$Metric <- "Weight"
  F.Weight.df <- F.Weight.df[-1,]

A.Weight.df <- tidy(A.Weight.mdl, quick = FALSE)
  ci <- as_tibble(confint(A.Weight.mdl))
  A.Weight.df$ci.lower <- ci$`2.5 %`
  A.Weight.df$ci.upper <- ci$`97.5 %`
  A.Weight.df$Dataset <- "All"
  A.Weight.df$Metric <- "Weight"
  A.Weight.df <- A.Weight.df[-1,]
  
Weight.df <- rbind(M.Weight.df, F.Weight.df, A.Weight.df)
```

### Weight Forest Plot

```{r Weight.fplot}
Weight.fplot <- ggplot(data = Weight.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper, color=Dataset),
                  linewidth=1, width=0.3, position=position_dodge(width=0.4))+
    geom_point(aes(x=term,y=estimate, color=Dataset), 
               shape = 16, size = 3, position=position_dodge(width=0.4))+
    scale_color_manual(name="", values=c("#000000","#E69F00","#56B4E9"),
                    labels=c("All","Female","Male"))+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip"))+
    #scale_y_continuous(limits = c(-0.3,0.25), breaks = c(-0.25,0,0.25))+
    #ggtitle("")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
Weight.fplot
#cowplot::save_plot("Plots/Weight.fplot.png", Weight.fplot, base_height = 4, base_width = 7)
```

### Weight Plots Wrapped

```{r Weight.wrap}
Weight.wrap <- ggarrange(Weight.fplot,WeightMinC.plot, ncol = 2, labels = c("A","B"), widths = c(1.7,1.3))
cowplot::save_plot("PaperPlots/Weight.wrap.png", Weight.wrap, base_height = 5, base_width = 12)
#Weight.wrap
```


## Nestling Tarsus 

### Tarsus by Minimum Temperature Plot

```{r TarsusMinC.plot}
TarsusMinC.plot <- ggplot(data = df, aes(x = MinC8_22, y = Tarsus, color = Sex))+
  geom_jitter(width = 0.2, shape = 1, size = 1.8)+
  geom_smooth(method="lm", aes(fill = Sex), alpha = 0.2)+
  scale_color_manual(name="Sex",
                    values=c("#E69F00","#56B4E9","#000000"),
                    labels=c("Female","Male","Unsexed"))+
  scale_fill_manual(values = c("#E69F00","#56B4E9","#000000"), guide = "none")+
  ylab("Tarsus (mm)")+
  xlab("Average minimum temperature (C)")+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_text(size = 14),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
TarsusMinC.plot
#cowplot::save_plot("Plots/TarsusMinC.plot.png", TarsusMinC.plot, base_height = 4, base_width = 7)
```

### Male Tarsus Model

```{r M.Tarsus.bmdl}
M.Tarsus.bmdl <- stan_glm(Tarsus ~ MinC8_22 * PrecipSum8_22 + Weight, 
                          data = M.scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              chains = 10, iter = 10000, cores = 2, seed = 666)
print(summary(M.Tarsus.bmdl), digits = 3)
#plot(M.Tarsus.bmdl)
```

```{r M.Tarsus.mdl}
# M.Tarsus.mdl <- lm(Tarsus ~ MinC8_22 * PrecipSum8_22 + Weight, data = M.scaled.df)
# summary(M.Tarsus.mdl)
```

### Female Tarsus Model
```{r F.Tarsus.bmdl}
F.Tarsus.bmdl <- stan_glm(Tarsus ~ MinC8_22 * PrecipSum8_22 + Weight, 
                          data = F.scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              chains = 10, iter = 10000, cores = 2, seed = 666)
print(summary(F.Tarsus.bmdl), digits = 3)
#plot(F.Tarsus.bmdl)
```

```{r F.Tarsus.mdl}
# F.Tarsus.mdl <- lm(Tarsus ~ MinC8_22 * PrecipSum8_22 + Weight, data = F.scaled.df)
# summary(F.Tarsus.mdl)
```


### All Nestlings Tarsus Model
```{r A.Tarsus.bmdl}
A.Tarsus.bmdl <- stan_glm(Tarsus ~ MinC8_22 * PrecipSum8_22 + Weight, 
                          data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              chains = 10, iter = 10000, cores = 2, seed = 666)
print(summary(A.Tarsus.bmdl), digits = 3)
#plot(A.Tarsus.bmdl)
```

```{r A.Tarsus.mdl}
# A.Tarsus.mdl <- lm(Tarsus ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df)
# summary(A.Tarsus.mdl)
```

### Data frames for Tarsus Forest Plot

```{r Tarsus.dfs for fplot}
M.Tarsus.df <- tidy(M.Tarsus.bmdl, quick = FALSE, conf.int = TRUE, looic = TRUE)
  M.Tarsus.df <- M.Tarsus.df[-1,]
  M.Tarsus.df$Dataset <- "Male"
  M.Tarsus.df$Metric <- "Tarsus"

F.Tarsus.df <- tidy(F.Tarsus.bmdl, quick = FALSE, conf.int = TRUE, looic = TRUE)
  F.Tarsus.df$Dataset <- "Female"
  F.Tarsus.df$Metric <- "Tarsus"
  F.Tarsus.df <- F.Tarsus.df[-1,]

A.Tarsus.df <- tidy(A.Tarsus.bmdl, quick = FALSE, conf.int = TRUE, looic = TRUE)
  A.Tarsus.df$Dataset <- "All"
  A.Tarsus.df$Metric <- "Tarsus"
  A.Tarsus.df <- A.Tarsus.df[-1,]
  
Tarsus.df <- rbind(M.Tarsus.df, F.Tarsus.df, A.Tarsus.df)
```

### Tarsus Forest Plot

```{r Tarsus.fplot}
Tarsus.fplot <- ggplot(data = Tarsus.df)+
    geom_errorbar(aes(x=term, ymin=conf.low, ymax=conf.high, color=Dataset),
                  linewidth=1, width=0.3, position=position_dodge(width=0.4))+
    geom_point(aes(x=term,y=estimate, color=Dataset), 
               shape = 16, size = 3, position=position_dodge(width=0.4))+
    scale_color_manual(name="", values=c("#000000","#E69F00","#56B4E9"),
                    labels=c("All","Female","Male"))+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",linewidth=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    #scale_y_continuous(limits = c(-0.3,0.25), breaks = c(-0.25,0,0.25))+
    #ggtitle("")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
Tarsus.fplot
#cowplot::save_plot("Plots/Tarsus.fplot.png", Tarsus.fplot, base_height = 4, base_width = 7)
```

### Tarsus Plots Wrapped

```{r Tarsus.wrap}
Tarsus.wrap <- ggarrange(Tarsus.fplot,TarsusMinC.plot, ncol = 2, labels = c("A","B"), widths = c(1.7,1.3))
cowplot::save_plot("PaperPlots/Tarsus.wrap.png", Tarsus.wrap, base_height = 5, base_width = 12)
#Tarsus.wrap
```

```{r M.Tarsus.pred}
M.Tarsus.pred <- ggpredict(M.Tarsus.bmdl, terms = c("MinC8_22","PrecipSum8_22"), ppd = TRUE)
```

```{r M.Tarsus.ME.plot}
M.Tarsus.ME.plot <- ggplot(data = M.Tarsus.pred, aes(x,predicted))+
  geom_point(data = M.scaled.df, aes(x=MinC8_22, y=Tarsus), shape = 1)+
  geom_line(color = "#009E73", size = 0.7)+
  geom_ribbon(aes(ymin=conf.low,ymax=conf.high), fill = "#009E73", alpha = 0.2)+
  ylab("Tarsus (mm) scaled")+
  xlab("Minimum temperature (C) scaled")
M.Tarsus.ME.plot
# cowplot::save_plot("Plots/BDbyMin.plot.png", BDbyMin.plot, base_height = 4, base_width = 6)
```
## Nestling Bill Depth

### Bill Depth by Minimum Temperature Plot

```{r BDMinC.plot}
BDMinC.plot <- ggplot(data = df, aes(x = MinC8_22, y = BD, color = Sex))+
  geom_jitter(width = 0.2, shape = 1, size = 1.8)+
  geom_smooth(method="lm", aes(fill = Sex), alpha = 0.2)+
  scale_color_manual(name="Sex",
                    values=c("#E69F00","#56B4E9","#000000"),
                    labels=c("Female","Male","Unsexed"))+
  scale_fill_manual(values = c("#E69F00","#56B4E9","#000000"), guide = "none")+
  ylab("Bill depth (mm)")+
  xlab("Average minimum temperature (C)")+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_text(size = 14),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
BDMinC.plot
#cowplot::save_plot("Plots/BDMinC.plot.png", BDMinC.plot, base_height = 4, base_width = 7)
```

### Male Bill Depth Model

```{r M.BD.mdl}
M.BD.mdl <- lm(BD ~ MinC8_22 * PrecipSum8_22 + Weight, data = M.scaled.df)
summary(M.BD.mdl)
```

### Female Bill Depth Model

```{r F.BD.mdl}
F.BD.mdl <- lm(BD ~ MinC8_22 * PrecipSum8_22 + Weight, data = F.scaled.df)
summary(F.BD.mdl)
```

### All Nestlings Bill Depth Model

```{r A.BD.mdl}
A.BD.mdl <- lm(BD ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df)
summary(A.BD.mdl)
```

### Data frames for Bill Depth Forest Plot

```{r BD.dfs for fplot}
M.BD.df <- tidy(M.BD.mdl, quick = FALSE)
  ci <- as_tibble(confint(M.BD.mdl))
  M.BD.df$ci.lower <- ci$`2.5 %`
  M.BD.df$ci.upper <- ci$`97.5 %`
  M.BD.df$Dataset <- "Male"
  M.BD.df$Metric <- "Bill Depth"
  M.BD.df <- M.BD.df[-1,]

F.BD.df <- tidy(F.BD.mdl, quick = FALSE)
  ci <- as_tibble(confint(F.BD.mdl))
  F.BD.df$ci.lower <- ci$`2.5 %`
  F.BD.df$ci.upper <- ci$`97.5 %`
  F.BD.df$Dataset <- "Female"
  F.BD.df$Metric <- "Bill Depth"
  F.BD.df <- F.BD.df[-1,]

A.BD.df <- tidy(A.BD.mdl, quick = FALSE)
  ci <- as_tibble(confint(A.BD.mdl))
  A.BD.df$ci.lower <- ci$`2.5 %`
  A.BD.df$ci.upper <- ci$`97.5 %`
  A.BD.df$Dataset <- "All"
  A.BD.df$Metric <- "Bill Depth"
  A.BD.df <- A.BD.df[-1,]
  
BD.df <- rbind(M.BD.df, F.BD.df, A.BD.df)
```

### Bill Depth Forest Plot

```{r BD.fplot}
BD.fplot <- ggplot(data = BD.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper, color=Dataset),
                  linewidth=1, width=0.3, position=position_dodge(width=0.4))+
    geom_point(aes(x=term,y=estimate, color=Dataset), 
               shape = 16, size = 3, position=position_dodge(width=0.4))+
    scale_color_manual(name="", values=c("#000000","#E69F00","#56B4E9"),
                    labels=c("All","Female","Male"))+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    #scale_y_continuous(limits = c(-0.3,0.25), breaks = c(-0.25,0,0.25))+
    #ggtitle("")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
BD.fplot
#cowplot::save_plot("Plots/BD.fplot.png", BD.fplot, base_height = 4, base_width = 7)
```

### Bill Depth Plots Wrapped

```{r BD.wrap}
BD.wrap <- ggarrange(BD.fplot,BDMinC.plot, ncol = 2, labels = c("A","B"), widths = c(1.7,1.3))
cowplot::save_plot("PaperPlots/BD.wrap.png", BD.wrap, base_height = 5, base_width = 12)
#BD.wrap
```


## Nestling Total Exposed Culmen (TEC) 

### TEC by Minimum Temperature Plot

```{r TECMinC.plot}
TECMinC.plot <- ggplot(data = df, aes(x = MinC8_22, y = TEC, color = Sex))+
  geom_jitter(width = 0.2, shape = 1, size = 1.8)+
  geom_smooth(method="lm", aes(fill = Sex), alpha = 0.2)+
  scale_color_manual(name="Sex",
                    values=c("#E69F00","#56B4E9","#000000"),
                    labels=c("Female","Male","Unknown"))+
  scale_fill_manual(values = c("#E69F00","#56B4E9","#000000"), guide = "none")+
  ylab("Total exposed culmen (mm)")+
  xlab("Average minimum temperature (C)")+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_text(size = 14),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
TECMinC.plot
#cowplot::save_plot("Plots/TECMinC.plot.png", TECMinC.plot, base_height = 4, base_width = 7)
```

### Male TEC Model

```{r M.TEC.mdl}
M.TEC.mdl <- lm(TEC ~ MinC8_22 * PrecipSum8_22 + Weight, data = M.scaled.df)
summary(M.TEC.mdl)
```

### Female TEC Model

```{r F.TEC.mdl}
F.TEC.mdl <- lm(TEC ~ MinC8_22 * PrecipSum8_22 + Weight, data = F.scaled.df)
summary(F.TEC.mdl)
```

### All Nestlings TEC Model

```{r A.TEC.mdl}
A.TEC.mdl <- lm(TEC ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df)
summary(A.TEC.mdl)
```

### Data frames for TEC Forest Plot

```{r TEC.dfs for fplot}
M.TEC.df <- tidy(M.TEC.mdl, quick = FALSE)
  ci <- as_tibble(confint(M.TEC.mdl))
  M.TEC.df$ci.lower <- ci$`2.5 %`
  M.TEC.df$ci.upper <- ci$`97.5 %`
  M.TEC.df$Dataset <- "Male"
  M.TEC.df$Metric <- "TEC"
  M.TEC.df <- M.TEC.df[-1,]

F.TEC.df <- tidy(F.TEC.mdl, quick = FALSE)
  ci <- as_tibble(confint(F.TEC.mdl))
  F.TEC.df$ci.lower <- ci$`2.5 %`
  F.TEC.df$ci.upper <- ci$`97.5 %`
  F.TEC.df$Dataset <- "Female"
  F.TEC.df$Metric <- "TEC"
  F.TEC.df <- F.TEC.df[-1,]

A.TEC.df <- tidy(A.TEC.mdl, quick = FALSE)
  ci <- as_tibble(confint(A.TEC.mdl))
  A.TEC.df$ci.lower <- ci$`2.5 %`
  A.TEC.df$ci.upper <- ci$`97.5 %`
  A.TEC.df$Dataset <- "All"
  A.TEC.df$Metric <- "TEC"
  A.TEC.df <- A.TEC.df[-1,]
  
TEC.df <- rbind(M.TEC.df, F.TEC.df, A.TEC.df)
```

### TEC Forest Plot

```{r TEC.fplot}
TEC.fplot <- ggplot(data = TEC.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper, color=Dataset),
                  linewidth=1, width=0.3, position=position_dodge(width=0.4))+
    geom_point(aes(x=term,y=estimate, color=Dataset), 
               shape = 16, size = 3, position=position_dodge(width=0.4))+
    scale_color_manual(name="", values=c("#000000","#E69F00","#56B4E9"),
                    labels=c("All","Female","Male"))+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    #scale_y_continuous(limits = c(-0.3,0.25), breaks = c(-0.25,0,0.25))+
    #ggtitle("")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
TEC.fplot
#cowplot::save_plot("Plots/TEC.fplot.png", TEC.fplot, base_height = 4, base_width = 7)
```

### TEC Plots Wrapped

```{r TEC.wrap}
TEC.wrap <- ggarrange(TEC.fplot,TECMinC.plot, ncol = 2, labels = c("A","B"), widths = c(1.7,1.3))
cowplot::save_plot("PaperPlots/TEC.wrap.png", TEC.wrap, base_height = 5, base_width = 12)
#TEC.wrap
```


## Nestling Bill Nares to Tip (BNT) 

### BNT by Minimum Temperature Plot

```{r BNTMinC.plot}
BNTMinC.plot <- ggplot(data = df, aes(x = MinC8_22, y = BNT, color = Sex))+
  geom_jitter(width = 0.2, shape = 1, size = 1.8)+
  geom_smooth(method="lm", aes(fill = Sex), alpha = 0.2)+
  scale_color_manual(name="Sex",
                    values=c("#E69F00","#56B4E9","#000000"),
                    labels=c("Female","Male","Unknown"))+
  scale_fill_manual(values = c("#E69F00","#56B4E9","#000000"), guide = "none")+
  ylab("Bill nares to tip (mm)")+
  xlab("Average minimum temperature (C)")+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_text(size = 14),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
BNTMinC.plot
#cowplot::save_plot("Plots/BNTMinC.plot.png", BNTMinC.plot, base_height = 4, base_width = 7)
```

### Male BNT Model

```{r M.BNT.mdl}
M.BNT.mdl <- lm(BNT ~ MinC8_22 * PrecipSum8_22 + Weight, data = M.scaled.df)
summary(M.BNT.mdl)
```

### Female BNT Model

```{r F.BNT.mdl}
F.BNT.mdl <- lm(BNT ~ MinC8_22 * PrecipSum8_22 + Weight, data = F.scaled.df)
summary(F.BNT.mdl)
```

### All Nestlings BNT Model

```{r A.BNT.mdl}
A.BNT.mdl <- lm(BNT ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df)
summary(A.BNT.mdl)
```

### Data frames for BNT Forest Plot

```{r BNT.dfs for fplot}
M.BNT.df <- tidy(M.BNT.mdl, quick = FALSE)
  ci <- as_tibble(confint(M.BNT.mdl))
  M.BNT.df$ci.lower <- ci$`2.5 %`
  M.BNT.df$ci.upper <- ci$`97.5 %`
  M.BNT.df$Dataset <- "Male"
  M.BNT.df$Metric <- "BNT"
  M.BNT.df <- M.BNT.df[-1,]

F.BNT.df <- tidy(F.BNT.mdl, quick = FALSE)
  ci <- as_tibble(confint(F.BNT.mdl))
  F.BNT.df$ci.lower <- ci$`2.5 %`
  F.BNT.df$ci.upper <- ci$`97.5 %`
  F.BNT.df$Dataset <- "Female"
  F.BNT.df$Metric <- "BNT"
  F.BNT.df <- F.BNT.df[-1,]

A.BNT.df <- tidy(A.BNT.mdl, quick = FALSE)
  ci <- as_tibble(confint(A.BNT.mdl))
  A.BNT.df$ci.lower <- ci$`2.5 %`
  A.BNT.df$ci.upper <- ci$`97.5 %`
  A.BNT.df$Dataset <- "All"
  A.BNT.df$Metric <- "BNT"
  A.BNT.df <- A.BNT.df[-1,]
  
BNT.df <- rbind(M.BNT.df, F.BNT.df, A.BNT.df)
```

### BNT Forest Plot

```{r BNT.fplot}
BNT.fplot <- ggplot(data = BNT.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper, color=Dataset),
                  linewidth=1, width=0.3, position=position_dodge(width=0.4))+
    geom_point(aes(x=term,y=estimate, color=Dataset), 
               shape = 16, size = 3, position=position_dodge(width=0.4))+
    scale_color_manual(name="", values=c("#000000","#E69F00","#56B4E9"),
                    labels=c("All","Female","Male"))+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    #scale_y_continuous(limits = c(-0.3,0.25), breaks = c(-0.25,0,0.25))+
    #ggtitle("")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
BNT.fplot
#cowplot::save_plot("Plots/BNT.fplot.png", BNT.fplot, base_height = 4, base_width = 7)
```

### BNT Plots Wrapped

```{r BNT.wrap}
BNT.wrap <- ggarrange(BNT.fplot,BNTMinC.plot, ncol = 2, labels = c("A","B"), widths = c(1.7,1.3))
cowplot::save_plot("PaperPlots/BNT.wrap.png", BNT.wrap, base_height = 5, base_width = 12)
#BNT.wrap
```


## Nestling Upper Bill (UB) 

### UB by Minimum Temperature Plot

```{r UBMinC.plot}
UBMinC.plot <- ggplot(data = df, aes(x = MinC8_22, y = UB, color = Sex))+
  geom_jitter(width = 0.2, shape = 1, size = 1.8)+
  geom_smooth(method="lm", aes(fill = Sex), alpha = 0.2)+
  scale_color_manual(name="Sex",
                    values=c("#E69F00","#56B4E9","#000000"),
                    labels=c("Female","Male","Unknown"))+
  scale_fill_manual(values = c("#E69F00","#56B4E9","#000000"), guide = "none")+
  ylab("Upper bill (mm)")+
  xlab("Average minimum temperature (C)")+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_text(size = 14),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
UBMinC.plot
#cowplot::save_plot("Plots/UBMinC.plot.png", UBMinC.plot, base_height = 4, base_width = 7)
```

### Male UB Model

```{r M.UB.mdl}
M.UB.mdl <- lm(UB ~ MinC8_22 * PrecipSum8_22 + Weight, data = M.scaled.df)
summary(M.UB.mdl)
```

### Female UB Model

```{r F.UB.mdl}
F.UB.mdl <- lm(UB ~ MinC8_22 * PrecipSum8_22 + Weight, data = F.scaled.df)
summary(F.UB.mdl)
```

### All Nestlings UB Model

```{r A.UB.mdl}
A.UB.mdl <- lm(UB ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df)
summary(A.UB.mdl)
```

### Data frames for UB Forest Plot

```{r UB.dfs for fplot}
M.UB.df <- tidy(M.UB.mdl, quick = FALSE)
  ci <- as_tibble(confint(M.UB.mdl))
  M.UB.df$ci.lower <- ci$`2.5 %`
  M.UB.df$ci.upper <- ci$`97.5 %`
  M.UB.df$Dataset <- "Male"
  M.UB.df$Metric <- "UB"
  M.UB.df <- M.UB.df[-1,]

F.UB.df <- tidy(F.UB.mdl, quick = FALSE)
  ci <- as_tibble(confint(F.UB.mdl))
  F.UB.df$ci.lower <- ci$`2.5 %`
  F.UB.df$ci.upper <- ci$`97.5 %`
  F.UB.df$Dataset <- "Female"
  F.UB.df$Metric <- "UB"
  F.UB.df <- F.UB.df[-1,]

A.UB.df <- tidy(A.UB.mdl, quick = FALSE)
  ci <- as_tibble(confint(A.UB.mdl))
  A.UB.df$ci.lower <- ci$`2.5 %`
  A.UB.df$ci.upper <- ci$`97.5 %`
  A.UB.df$Dataset <- "All"
  A.UB.df$Metric <- "UB"
  A.UB.df <- A.UB.df[-1,]
  
UB.df <- rbind(M.UB.df, F.UB.df, A.UB.df)
```

### UB Forest Plot

```{r UB.fplot}
UB.fplot <- ggplot(data = UB.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper, color=Dataset),
                  linewidth=1, width=0.3, position=position_dodge(width=0.4))+
    geom_point(aes(x=term,y=estimate, color=Dataset), 
               shape = 16, size = 3, position=position_dodge(width=0.4))+
    scale_color_manual(name="", values=c("#000000","#E69F00","#56B4E9"),
                    labels=c("All","Female","Male"))+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    #scale_y_continuous(limits = c(-0.3,0.25), breaks = c(-0.25,0,0.25))+
    #ggtitle("")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
UB.fplot
#cowplot::save_plot("Plots/UB.fplot.png", UB.fplot, base_height = 4, base_width = 7)
```

### UB Plots Wrapped

```{r UB.wrap}
UB.wrap <- ggarrange(UB.fplot,UBMinC.plot, ncol = 2, labels = c("A","B"), widths = c(1.7,1.3))
cowplot::save_plot("PaperPlots/UB.wrap.png", UB.wrap, base_height = 5, base_width = 12)
#UB.wrap
```


## Nestling Upper Bill Surface Area (UBS) 

### UBS by Minimum Temperature Plot

```{r UBSMinC.plot}
UBSMinC.plot <- ggplot(data = df, aes(x = MinC8_22, y = UBS, color = Sex))+
  geom_jitter(width = 0.2, shape = 1, size = 1.8)+
  geom_smooth(method="lm", aes(fill = Sex), alpha = 0.2)+
  scale_color_manual(name="Sex",
                    values=c("#E69F00","#56B4E9","#000000"),
                    labels=c("Female","Male","Unknown"))+
  scale_fill_manual(values = c("#E69F00","#56B4E9","#000000"), guide = "none")+
  labs(x = "Average minimum temperature (C)", y = bquote('Upper bill surface area' ~(mm^2)))+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_text(size = 14),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
UBSMinC.plot
#cowplot::save_plot("Plots/UBSMinC.plot.png", UBSMinC.plot, base_height = 4, base_width = 7)
```

### Male UBS Model

```{r M.UBS.mdl}
M.UBS.mdl <- lm(UBS ~ MinC8_22 * PrecipSum8_22 + Weight, data = M.scaled.df)
summary(M.UBS.mdl)
```

### Female UBS Model

```{r F.UBS.mdl}
F.UBS.mdl <- lm(UBS ~ MinC8_22 * PrecipSum8_22 + Weight, data = F.scaled.df)
summary(F.UBS.mdl)
```

### All Nestlings UBS Model

```{r A.UBS.mdl}
A.UBS.mdl <- lm(UBS ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df)
summary(A.UBS.mdl)
```

### Data frames for UBS Forest Plot

```{r UBS.dfs for fplot}
M.UBS.df <- tidy(M.UBS.mdl, quick = FALSE)
  ci <- as_tibble(confint(M.UBS.mdl))
  M.UBS.df$ci.lower <- ci$`2.5 %`
  M.UBS.df$ci.upper <- ci$`97.5 %`
  M.UBS.df$Dataset <- "Male"
  M.UBS.df$Metric <- "UBS"
  M.UBS.df <- M.UBS.df[-1,]

F.UBS.df <- tidy(F.UBS.mdl, quick = FALSE)
  ci <- as_tibble(confint(F.UBS.mdl))
  F.UBS.df$ci.lower <- ci$`2.5 %`
  F.UBS.df$ci.upper <- ci$`97.5 %`
  F.UBS.df$Dataset <- "Female"
  F.UBS.df$Metric <- "UBS"
  F.UBS.df <- F.UBS.df[-1,]

A.UBS.df <- tidy(A.UBS.mdl, quick = FALSE)
  ci <- as_tibble(confint(A.UBS.mdl))
  A.UBS.df$ci.lower <- ci$`2.5 %`
  A.UBS.df$ci.upper <- ci$`97.5 %`
  A.UBS.df$Dataset <- "All"
  A.UBS.df$Metric <- "UBS"
  A.UBS.df <- A.UBS.df[-1,]
  
UBS.df <- rbind(M.UBS.df, F.UBS.df, A.UBS.df)
```

### UBS Forest Plot

```{r UBS.fplot}
UBS.fplot <- ggplot(data = UBS.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper, color=Dataset),
                  linewidth=1, width=0.3, position=position_dodge(width=0.4))+
    geom_point(aes(x=term,y=estimate, color=Dataset), 
               shape = 16, size = 3, position=position_dodge(width=0.4))+
    scale_color_manual(name="", values=c("#000000","#E69F00","#56B4E9"),
                    labels=c("All","Female","Male"))+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    #scale_y_continuous(limits = c(-0.3,0.25), breaks = c(-0.25,0,0.25))+
    #ggtitle("")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
UBS.fplot
#cowplot::save_plot("Plots/UBS.fplot.png", UBS.fplot, base_height = 4, base_width = 7)
```

### UBS Plots Wrapped

```{r UBS.wrap}
UBS.wrap <- ggarrange(UBS.fplot,UBSMinC.plot, ncol = 2, labels = c("A","B"), widths = c(1.7,1.3))
cowplot::save_plot("PaperPlots/UBS.wrap.png", UBS.wrap, base_height = 5, base_width = 12)
#UBS.wrap
```


## Nestling Total Bill Surface Area (TBS) 

### TBS by Minimum Temperature Plot

```{r TBSMinC.plot}
TBSMinC.plot <- ggplot(data = df, aes(x = MinC8_22, y = TBS, color = Sex))+
  geom_jitter(width = 0.2, shape = 1, size = 1.8)+
  geom_smooth(method="lm", aes(fill = Sex), alpha = 0.2)+
  scale_color_manual(name="Sex",
                    values=c("#E69F00","#56B4E9","#000000"),
                    labels=c("Female","Male","Unknown"))+
  scale_fill_manual(values = c("#E69F00","#56B4E9","#000000"), guide = "none")+
  labs(x = "Average minimum temperature (C)", y = bquote('Total bill surface area' ~(mm^2)))+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_text(size = 14),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
TBSMinC.plot
#cowplot::save_plot("Plots/TBSMinC.plot.png", TBSMinC.plot, base_height = 4, base_width = 7)
```

### Male TBS Model

```{r M.TBS.mdl}
M.TBS.mdl <- lm(TBS ~ MinC8_22 * PrecipSum8_22 + Weight, data = M.scaled.df)
summary(M.TBS.mdl)
```

### Female TBS Model

```{r F.TBS.mdl}
F.TBS.mdl <- lm(TBS ~ MinC8_22 * PrecipSum8_22 + Weight, data = F.scaled.df)
summary(F.TBS.mdl)
```

### All Nestlings TBS Model

```{r A.TBS.mdl}
A.TBS.mdl <- lm(TBS ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df)
summary(A.TBS.mdl)
```

### Data frames for TBS Forest Plot

```{r TBS.dfs for fplot}
M.TBS.df <- tidy(M.TBS.mdl, quick = FALSE)
  ci <- as_tibble(confint(M.TBS.mdl))
  M.TBS.df$ci.lower <- ci$`2.5 %`
  M.TBS.df$ci.upper <- ci$`97.5 %`
  M.TBS.df$Dataset <- "Male"
  M.TBS.df$Metric <- "TBS"
  M.TBS.df <- M.TBS.df[-1,]

F.TBS.df <- tidy(F.TBS.mdl, quick = FALSE)
  ci <- as_tibble(confint(F.TBS.mdl))
  F.TBS.df$ci.lower <- ci$`2.5 %`
  F.TBS.df$ci.upper <- ci$`97.5 %`
  F.TBS.df$Dataset <- "Female"
  F.TBS.df$Metric <- "TBS"
  F.TBS.df <- F.TBS.df[-1,]

A.TBS.df <- tidy(A.TBS.mdl, quick = FALSE)
  ci <- as_tibble(confint(A.TBS.mdl))
  A.TBS.df$ci.lower <- ci$`2.5 %`
  A.TBS.df$ci.upper <- ci$`97.5 %`
  A.TBS.df$Dataset <- "All"
  A.TBS.df$Metric <- "TBS"
  A.TBS.df <- A.TBS.df[-1,]
  
TBS.df <- rbind(M.TBS.df, F.TBS.df, A.TBS.df)
```

### TBS Forest Plot

```{r TBS.fplot}
TBS.fplot <- ggplot(data = TBS.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper, color=Dataset),
                  linewidth=1, width=0.3, position=position_dodge(width=0.4))+
    geom_point(aes(x=term,y=estimate, color=Dataset), 
               shape = 16, size = 3, position=position_dodge(width=0.4))+
    scale_color_manual(name="", values=c("#000000","#E69F00","#56B4E9"),
                    labels=c("All","Female","Male"))+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    #scale_y_continuous(limits = c(-0.3,0.25), breaks = c(-0.25,0,0.25))+
    #ggtitle("")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
TBS.fplot
#cowplot::save_plot("Plots/TBS.fplot.png", TBS.fplot, base_height = 4, base_width = 7)
```

### TBS Plots Wrapped

```{r TBS.wrap}
TBS.wrap <- ggarrange(TBS.fplot,TBSMinC.plot, ncol = 2, labels = c("A","B"), widths = c(1.7,1.3))
cowplot::save_plot("PaperPlots/TBS.wrap.png", TBS.wrap, base_height = 5, base_width = 12)
#TBS.wrap
```


## Nestling Skull

### Skull by Minimum Temperature Plot

```{r SkullMinC.plot}
SkullMinC.plot <- ggplot(data = df, aes(x = MinC8_22, y = Skull, color = Sex))+
  geom_jitter(width = 0.2, shape = 1, size = 1.8)+
  geom_smooth(method="lm", aes(fill = Sex), alpha = 0.2)+
  scale_color_manual(name="Sex",
                    values=c("#E69F00","#56B4E9","#000000"),
                    labels=c("Female","Male","Unknown"))+
  scale_fill_manual(values = c("#E69F00","#56B4E9","#000000"), guide = "none")+
  labs(x = "Average minimum temperature (C)", y = "Skull (mm)")+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_text(size = 14),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
SkullMinC.plot
#cowplot::save_plot("Plots/SkullMinC.plot.png", SkullMinC.plot, base_height = 4, base_width = 7)
```

### Male Skull Model

```{r M.Skull.mdl}
M.Skull.mdl <- lm(Skull ~ MinC8_22 * PrecipSum8_22 + Weight, data = M.scaled.df)
summary(M.Skull.mdl)
```

### Female Skull Model

```{r F.Skull.mdl}
F.Skull.mdl <- lm(Skull ~ MinC8_22 * PrecipSum8_22 + Weight, data = F.scaled.df)
summary(F.Skull.mdl)
```

### All Nestlings Skull Model

```{r A.Skull.mdl}
A.Skull.mdl <- lm(Skull ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df)
summary(A.Skull.mdl)
```

### Data frames for Skull Forest Plot

```{r Skull.dfs for fplot}
M.Skull.df <- tidy(M.Skull.mdl, quick = FALSE)
  ci <- as_tibble(confint(M.Skull.mdl))
  M.Skull.df$ci.lower <- ci$`2.5 %`
  M.Skull.df$ci.upper <- ci$`97.5 %`
  M.Skull.df$Dataset <- "Male"
  M.Skull.df$Metric <- "Skull"
  M.Skull.df <- M.Skull.df[-1,]

F.Skull.df <- tidy(F.Skull.mdl, quick = FALSE)
  ci <- as_tibble(confint(F.Skull.mdl))
  F.Skull.df$ci.lower <- ci$`2.5 %`
  F.Skull.df$ci.upper <- ci$`97.5 %`
  F.Skull.df$Dataset <- "Female"
  F.Skull.df$Metric <- "Skull"
  F.Skull.df <- F.Skull.df[-1,]

A.Skull.df <- tidy(A.Skull.mdl, quick = FALSE)
  ci <- as_tibble(confint(A.Skull.mdl))
  A.Skull.df$ci.lower <- ci$`2.5 %`
  A.Skull.df$ci.upper <- ci$`97.5 %`
  A.Skull.df$Dataset <- "All"
  A.Skull.df$Metric <- "Skull"
  A.Skull.df <- A.Skull.df[-1,]
  
Skull.df <- rbind(M.Skull.df, F.Skull.df, A.Skull.df)
```

### Skull Forest Plot

```{r Skull.fplot}
Skull.fplot <- ggplot(data = Skull.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper, color=Dataset),
                  linewidth=1, width=0.3, position=position_dodge(width=0.4))+
    geom_point(aes(x=term,y=estimate, color=Dataset), 
               shape = 16, size = 3, position=position_dodge(width=0.4))+
    scale_color_manual(name="", values=c("#000000","#E69F00","#56B4E9"),
                    labels=c("All","Female","Male"))+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    #scale_y_continuous(limits = c(-0.3,0.25), breaks = c(-0.25,0,0.25))+
    #ggtitle("")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
Skull.fplot
#cowplot::save_plot("Plots/Skull.fplot.png", Skull.fplot, base_height = 4, base_width = 7)
```

### Skull Plots Wrapped

```{r Skull.wrap}
Skull.wrap <- ggarrange(Skull.fplot,SkullMinC.plot, ncol = 2, labels = c("A","B"), widths = c(1.7,1.3))
cowplot::save_plot("PaperPlots/Skull.wrap.png", Skull.wrap, base_height = 5, base_width = 12)
#Skull.wrap
```

