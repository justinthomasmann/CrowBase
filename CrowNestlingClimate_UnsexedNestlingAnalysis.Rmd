---
title: "Unsexed Nestling Analysis"
author: "Justin Mann"
date: "`r Sys.Date()`"
output: html_document
---

```{r libraries, include=FALSE}
library(tidyverse)
library(broom) #tidy() to create tibbles from model summaries
library(car) #vif (variance inflation factor for measuring covariance)
library(cowplot)
library(lme4) #frequentist models  
library(sjPlot) #plot_model & tab_model (blue = #377EB8)
library(ggpubr) #ggarrange for plot wraps
library(lmerTest) #lmerTest::step
library(ggeffects) #ggpredict
library(plotly) #ggplotly() to make interactive plots with scroll over ids
library(MuMIn) #dredge() for unsupervised model selection
library(AICcmodavg) #aictab() for AICc model comparisons
library(DHARMa) #model validation functions
library(DescTools) #Entropy() and MutInf()

#Libraries for Bayesian Models
library(rstanarm) #stan models
library(shinystan) #stan model evaluation
#launch_shinystan_demo()
library(loo) #use loo() to compare fits between bayesian models

#Clustering libraries
library(umap)
library(tsne)
library(ggfortify)#use autoplot() to visualize PCAs
library(stpm)#stochastic process model
theme_set(theme_classic()) #default plots with no gridlines
```
<br>

## Nestling Data and Climate metrics

```{r dataframe}
df <- read.csv("CrowNestlingClimate_AllNestlingsCleaned&ClimateJoinedNEW.csv", h=TRUE)
#n=1863 nestlings, 41 variables 
```
<br>



## Normalize Continuous Data

Subtract each value from the mean (center) and divide it by the standard deviation

```{r scaling}
#categorical data  
categorical.df <- df[,1:9]

#continuous data
continuous.df <- df[,10:41]

#scale continuous data
#?scale()
scaled.mat <- scale(continuous.df, center = TRUE, scale = TRUE)

#join unscaled and scaled data
scaled.df <- cbind(categorical.df,scaled.mat)
scaled.df$UBSWeightRatio <- scaled.df$UBS/scaled.df$Weight
```

<br>

Summarize the unscaled data

```{r data summary }
summary(df)
```


Summarize the scaled data

```{r scaled data summary}
summary(scaled.df)
```
<br>

```{r data frame with only sexed nestlings}
#Males Scaled
M.scaled.df <- subset(scaled.df, AllSex=="M")
#Males Unscaled
M.df <- subset(df, AllSex=="M")

#Females Scaled
F.scaled.df <- subset(scaled.df, AllSex=="F")
#Females Unscaled
F.df <- subset(df, AllSex=="F")

#Both sexes scaled
B.scaled.df <- rbind(F.scaled.df,M.scaled.df)
#Both sexes unscaled
B.df <- rbind(F.df,M.df)
```
<br>

## How is nestling weight affected by minimum temperature and precipitation?
```{r WeightbyMin.mdl}
MinC8_22.Weight.mdl <- lm(Weight ~ MinC8_22 * PrecipSum8_22, data = scaled.df, na.action = "na.fail")
summary(MinC8_22.Weight.mdl)
```

```{r Weight MinC8_22.mdl fplot.df}
Weight.df <- tidy(MinC8_22.Weight.mdl, quick = FALSE)
  ci <- as_tibble(confint(MinC8_22.Weight.mdl))
  Weight.df$ci.lower <- ci$`2.5 %`
  Weight.df$ci.upper <- ci$`97.5 %`
  Weight.df$Metric <- "Upper bill surface area"
  Weight.df <- Weight.df[-1,]
```

```{r WeightbyMin.plot}
WeightbyMin.plot <- ggplot(data = scaled.df, aes(x = MinC8_22, y = Weight))+
  geom_point(shape = 1)+
  geom_smooth(method = "lm", fill = "#1E88E5", color = "#1E88E5", alpha = 0.2)+
  ylab("Weight (g) scaled")+
  xlab("Mean minimum temperature (C) scaled")+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 12),
          axis.title.y = element_text(size =14),
          legend.position = "none",
          plot.margin = margin(15,15,15,15))
WeightbyMin.plot
#cowplot::save_plot("Plots/WeightbyMin.plot.png", WeightbyMin.plot, base_height = 4, base_width = 7)
```
```{r Weight.fplot}
Weight.fplot <- ggplot(data = Weight.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper), color = "black", size=1, width=0.3)+
    geom_point(aes(x=term,y=estimate), color = "black", shape = 16, size = 3)+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip"))+
    scale_y_continuous(limits = c(-0.3,0.25), breaks = c(-0.25,0,0.25))+
    #ggtitle("Parameters affecting nestling weight")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "none",
          plot.margin = margin(15,15,15,15))
Weight.fplot
#cowplot::save_plot("Plots/Weight.fplot.png", Weight.fplot, base_height = 4, base_width = 7)
```

```{r Weight.wrap}
Weight.wrap <- ggarrange(Weight.fplot,WeightbyMin.plot, ncol = 2, labels = c("A","B"), widths = c(1.3,1.7))
cowplot::save_plot("Plots/Weight.wrap.png", Weight.wrap, base_height = 5, base_width = 12)
```


```{r WeightbyPrecip.plot}
WeightbyPrecip.plot <- ggplot(data = df, aes(x = PrecipSum8_22, y = Weight))+
  geom_point(shape = 1)+
  geom_smooth()+
  ylab("Weight (g)")+
  xlab("Summed precipitation (cm)")
WeightbyPrecip.plot
#cowplot::save_plot("Plots/WeightbyPrecip.plot.png", WeightbyPrecip.plot, base_height = 4, base_width = 7)
```


```{r UBSbyMin.plot}
UBSbyMin.plot <- ggplot(data = df, aes(x = MinC8_22, y = UBS))+
  geom_point(shape = 1)+
  geom_smooth(method = "lm", fill = "#1E88E5", color = "#1E88E5", alpha = 0.2)+
  ylab("Upper Bill Surface Area (mm^2)")+
  xlab("Mean minimum temperature (C) days 8-22")
UBSbyMin.plot
#cowplot::save_plot("Plots/UBSbyMin.plot.png", UBSbyMin.plot, base_height = 4, base_width = 7)
```

```{r UBSWeightRatiobyMin.plot}
UBSWeightRatiobyMin.plot <- ggplot(data = scaled.df, aes(x = MinC8_22, y = UBSWeightRatio))+
  geom_point(shape = 1)+
  geom_smooth(method = "lm", fill = "#D81B60", color = "#D81B60", alpha = 0.2)+
  scale_y_continuous(limits = c(-5,5))+
  ylab("Upper Bill Surface Area (mm^2)")+
  xlab("Mean minimum temperature (C) days 8-22")
UBSWeightRatiobyMin.plot
#cowplot::save_plot("Plots/WeightbyMin.plot.png", WeightbyMin.plot, base_height = 4, base_width = 7)
```


```{r USBWeightRatiobyMin.mdl}
MinC8_22.UBSWR.mdl <- lm(UBSWeightRatio ~ MinC8_22 * PrecipSum8_22, data = scaled.df, na.action = "na.fail")
summary(MinC8_22.UBSWR.mdl)
```


## Upper Bill Surface Area (UBS)

```{r UBS.mdl}
MinC8_22.UBS.mdl <- lm(UBS ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df, na.action = "na.fail")
summary(MinC8_22.UBS.mdl)
```


```{r UBS climate time period best model predition}
UBS.pred <- ggpredict(MinC8_22.UBS.mdl, type = "fe", terms = ~MinC8_22)
UBS.pred
```

```{r UBS climate metric best model plot}
UBSbyMin.plot <- ggplot(data = UBS.pred, aes(x,predicted))+
  geom_point(data = scaled.df, aes(x=MinC8_22, y=UBS), shape = 1)+
  geom_line(color = "#1E88E5", size = 0.7)+
  geom_ribbon(aes(ymin=conf.low,ymax=conf.high), fill = "#1E88E5", alpha = 0.2)+
  ylab("Upper bill surface area (mm^2) scaled")+
  xlab("Mean minimum temperature (C) scaled")
UBSbyMin.plot
#cowplot::save_plot("Plots/UBSbyMin.plot.png", UBSbyMin.plot, base_height = 4, base_width = 6)
```

```{r UBS MinC8_22.mdl fplot.df}
UBS.df <- tidy(MinC8_22.UBS.mdl, quick = FALSE)
  ci <- as_tibble(confint(MinC8_22.UBS.mdl))
  UBS.df$ci.lower <- ci$`2.5 %`
  UBS.df$ci.upper <- ci$`97.5 %`
  UBS.df$Metric <- "Upper bill surface area"
  UBS.df <- UBS.df[-1,]
```

```{r UBS.fplot}
UBS.fplot <- ggplot(data = UBS.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper), color = "black", size=1, width=0.3)+
    geom_point(aes(x=term,y=estimate), color = "black", shape = 16, size = 3)+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    scale_y_continuous(limits = c(-0.3,0.7))+
    #ggtitle("Parameters affecting upper bill surface area")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "none",
          plot.margin = margin(15,15,15,15))
UBS.fplot
#cowplot::save_plot("Plots/UBS.fplot.png", UBS.fplot, base_height = 4, base_width = 7)
```


```{r UBS.wrap}
UBS.wrap <- ggarrange(UBS.fplot,UBSbyMin.plot, ncol = 2, labels = c("A","B"), widths = c(1.3,1.7))
cowplot::save_plot("Plots/UBS.wrap.png", UBS.wrap, base_height = 5, base_width = 12)
```



## Bill Depth

```{r BD.mdl}
MinC8_22.BD.mdl <- lm(BD ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df, na.action = "na.fail")
summary(MinC8_22.BD.mdl)
```


```{r BD climate time period best model predition}
BD.pred <- ggpredict(MinC8_22.BD.mdl, type = "fe", terms = ~MinC8_22)
BD.pred
```

```{r BD climate metric best model plot}
BDbyMin.plot <- ggplot(data = BD.pred, aes(x,predicted))+
  geom_point(data = scaled.df, aes(x=MinC8_22, y=BD), shape = 1)+
  geom_line(color = "#1E88E5", size = 0.7)+
  geom_ribbon(aes(ymin=conf.low,ymax=conf.high), fill = "#1E88E5", alpha = 0.2)+
  ylab("Bill Depth (mm) scaled")+
  xlab("Mean minimum temperature (C) scaled")
BDbyMin.plot
#cowplot::save_plot("Plots/BDbyMin.plot.png", BDbyMin.plot, base_height = 4, base_width = 6)
```

```{r BD interaction plot}
BDInter.plot <- plot_model(MinC8_22.BD.mdl, type = "int", mdrt.values = "quart")+
  scale_color_manual(name="Precipitation Quartiles",
                    values=c("#D81B60","#FFC107","#1E88E5"),
                    breaks =  c(-0.75,-0.26,0.58),
                    labels=c("Lower","Median","Upper"))+
  scale_fill_manual(values = c("#D81B60","#FFC107","#1E88E5"))+
  ggtitle("")+
  xlab("Scaled minimum temperature")+
  ylab("Scaled upper bill size")+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 12),
          axis.title.y = element_text(size = 14),
          legend.position = c(0.5,0.95))
BDInter.plot
#cowplot::save_plot("Plots/BDbyMin.plot.png", BDbyMin.plot, base_height = 4, base_width = 6)
```


```{r BD MinC8_22.mdl fplot.df}
BD.df <- tidy(MinC8_22.BD.mdl, quick = FALSE)
  ci <- as_tibble(confint(MinC8_22.BD.mdl))
  BD.df$ci.lower <- ci$`2.5 %`
  BD.df$ci.upper <- ci$`97.5 %`
  BD.df$Metric <- "Bill Depth"
  BD.df <- BD.df[-1,]
```

```{r BD.fplot}
BD.fplot <- ggplot(data = BD.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper), color = "black", size=1, width=0.3)+
    geom_point(aes(x=term,y=estimate), color = "black", shape = 16, size = 3)+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    scale_y_continuous(limits = c(-0.3,0.7))+
    #ggtitle("Parameters affecting upper bill surface area")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "none",
          plot.margin = margin(15,15,15,15))
BD.fplot
#cowplot::save_plot("Plots/BD.fplot.png", BD.fplot, base_height = 4, base_width = 7)
```


```{r BD.wrap}
BD.wrap <- ggarrange(BD.fplot,BDbyMin.plot, ncol = 2, labels = c("A","B"), widths = c(1.3,1.7))
cowplot::save_plot("Plots/BD.wrap.png", BD.wrap, base_height = 5, base_width = 12)
```


## Upper Bill

```{r UB.mdl}
MinC8_22.UB.mdl <- lm(UB ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df, na.action = "na.fail")
summary(MinC8_22.UB.mdl)
```


```{r UB climate time period best model predition}
UB.pred <- ggpredict(MinC8_22.BD.mdl, type = "fe", terms = ~PrecipSum8_22)
UB.pred
```

```{r UB climate metric best model plot}
UBbyMin.plot <- ggplot(data = UB.pred, aes(x,predicted))+
  geom_point(data = scaled.df, aes(x=PrecipSum8_22, y=UB), shape = 1)+
  geom_line(color = "#1E88E5", size = 0.7)+
  geom_ribbon(aes(ymin=conf.low,ymax=conf.high), fill = "#1E88E5", alpha = 0.2)+
  ylab("Upper bill (mm) scaled")+
  xlab("Summed precipitation (cm) scaled")
UBbyMin.plot
#cowplot::save_plot("Plots/UBbyMin.plot.png", UBbyMin.plot, base_height = 4, base_width = 6)
```

```{r UB MinC8_22.mdl fplot.df}
UB.df <- tidy(MinC8_22.UB.mdl, quick = FALSE)
  ci <- as_tibble(confint(MinC8_22.UB.mdl))
  UB.df$ci.lower <- ci$`2.5 %`
  UB.df$ci.upper <- ci$`97.5 %`
  UB.df$Metric <- "Upper Bill"
  UB.df <- UB.df[-1,]
```

```{r UB.fplot}
UB.fplot <- ggplot(data = UB.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper), color = "black", size=1, width=0.3)+
    geom_point(aes(x=term,y=estimate), color = "black", shape = 16, size = 3)+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    scale_y_continuous(limits = c(-0.3,0.7))+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "none",
          plot.margin = margin(15,15,15,15))
UB.fplot
#cowplot::save_plot("Plots/UB.fplot.png", UB.fplot, base_height = 4, base_width = 7)
```


```{r UB.wrap}
UB.wrap <- ggarrange(UB.fplot,UBbyMin.plot, ncol = 2, labels = c("A","B"), widths = c(1.3,1.7))
cowplot::save_plot("Plots/UB.wrap.png", UB.wrap, base_height = 5, base_width = 12)
```


## Unsupervised model selection

### What climate metrics best explain variation in bill shape? 

Here, we'll compare AIC values from models using MinC, MaxC, and GDD10CSum temperatures for days 12-22. 

```{r bill depth climate metric models}
MinC.BD.mdl <- lm(BD ~ MinC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

MaxC.BD.mdl <- lm(BD ~ MaxC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

GDD10C.BD.mdl <- lm(BD ~ GDD10CSum12_22 + MinC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")
```


```{r bill depth climate metric model comparison}
BD12_22Mods <- list(MinC.BD.mdl,MaxC.BD.mdl,GDD10C.BD.mdl)
BD12_22ModNames <- c('MinC','MaxC','GDD10CSum')
aictab(cand.set = BD12_22Mods, modnames = BD12_22ModNames, sort = TRUE)
```
<br>

MinC Model fits the data best; GDD is second best. But the delta AICc is 11.28 between the top two models. Comparing the model summaries below, MinC and Precip have slightly higher estimates but also a slightly higher std. errors.

```{r BD climate metric best model summary}
summary(MinC.BD.mdl)
```
<br>

Using MinC as the best fit metric from above, here we'll look at whether days 1-11, 12-22, 6-19, or 8-22 differ in how they fit the data.
```{r bill depth time period models}
MinC1_11.BD.mdl <- lm(BD ~ MinC1_11 * PrecipSum1_11 + Weight, data = scaled.df, na.action = "na.fail")

MinC12_22.BD.mdl <- lm(BD ~ MinC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

MinC6_19.BD.mdl <- lm(BD ~ MinC6_19 * PrecipSum6_19 + Weight, data = scaled.df, na.action = "na.fail")

MinC8_22.BD.mdl <- lm(BD ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df, na.action = "na.fail")

```

```{r bill depth time period model comparison}
BDTimeMods <- list(MinC1_11.BD.mdl,MinC12_22.BD.mdl,MinC6_19.BD.mdl,MinC8_22.BD.mdl)
BDTimeModNames <- c('MinC1_11','MinC12_22','MinC6_19',"MinC8_22")
aictab(cand.set = BDTimeMods, modnames = BDTimeModNames, sort = TRUE)
```

```{r bill depth time period model}
summary(MinC8_22.BD.mdl)
```
<br>

```{r BD MinC8_22.mdl fplot.df}
BD.df <- tidy(MinC8_22.BD.mdl, quick = FALSE)
  ci <- as_tibble(confint(MinC8_22.BD.mdl))
  BD.df$ci.lower <- ci$`2.5 %`
  BD.df$ci.upper <- ci$`97.5 %`
  BD.df$Metric <- "Bill Depth"
  BD.df <- BD.df[-1,]
```

```{r BD.fplot}
BD.fplot <- ggplot(data = BD.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper), color = "black", size=1, width=0.3)+
    geom_point(aes(x=term,y=estimate), color = "black", shape = 16, size = 3)+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    scale_y_continuous(limits = c(-0.3,0.7))+
    ggtitle("Parameters affecting bill depth")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "none",
          plot.margin = margin(15,15,15,15))
BD.fplot
#cowplot::save_plot("Plots/BD.fplot.png", BD.fplot, base_height = 4, base_width = 7)
```

```{r BD climate time period best model predition}
MinC8_22.pred <- ggpredict(MinC8_22.BD.mdl, type = "fe", terms = ~ MinC8_22)
MinC8_22.pred
```
```{r BD climate metric best model plot}
BDbyMin.plot <- ggplot(data = MinC8_22.pred, aes(x,predicted))+
  geom_point(data = scaled.df, aes(x=MinC8_22, y=BD), shape = 1)+
  geom_line(color = "#009E73", size = 0.7)+
  geom_ribbon(aes(ymin=conf.low,ymax=conf.high), fill = "#009E73", alpha = 0.2)+
  ylab("Bill depth (mm) scaled")+
  xlab("Minimum temperature (C) scaled")
BDbyMin.plot
cowplot::save_plot("Plots/BDbyMin.plot.png", BDbyMin.plot, base_height = 4, base_width = 6)
```


```{r BD interplot}
BD.intplot <- plot_model(MinC8_22.BD.mdl, type = "int", mdrt.values = "quart")
BD.intplot
BD.intplot <- BD.intplot +
  scale_color_manual(name="Precipitation Quartiles", values=c("#FFC107","#1E88E5","#D81B60"), breaks =  c(-0.75,-0.26,0.59), labels=c("Lower","Median","Upper"))+
  scale_fill_manual(values = c("#FFC107","#1E88E5","#D81B60"))+
  ggtitle("")+
  xlab("Minimum temperature (C) scaled")+
  ylab("Bill depth (mm) scaled")+
  theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 12),
          axis.title.y = element_text(size = 14),
          legend.position = c(0.25,0.85))
BD.intplot
cowplot::save_plot("Plots/BD.intplot.png", BD.intplot, base_height = 4, base_width = 6)
```


## Tarsus for comparison with bill depth

```{r tarsus MinC8_22.mdl}
MinC8_22.Tarsus.mdl <- lm(Tarsus ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df, na.action = "na.fail")
summary(MinC8_22.Tarsus.mdl)
```

```{r Tarsus MinC8_22.mdl fplot.df}
Tarsus.df <- tidy(MinC8_22.Tarsus.mdl, quick = FALSE)
  ci <- as_tibble(confint(MinC8_22.Tarsus.mdl))
  Tarsus.df$ci.lower <- ci$`2.5 %`
  Tarsus.df$ci.upper <- ci$`97.5 %`
  Tarsus.df$Metric <- "Tarsus"
  Tarsus.df <- Tarsus.df[-1,]
```

```{r Tarsus.fplot}
Tarsus.fplot <- ggplot(data = Tarsus.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper), color = "black", size=1, width=0.3)+
    geom_point(aes(x=term,y=estimate), color = "black", shape = 16, size = 3)+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    #scale_y_continuous(limits = c(-0.3,1))+
    ggtitle("Parameters affecting tarsus length")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "none",
          plot.margin = margin(15,15,15,15))
Tarsus.fplot
#cowplot::save_plot("Plots/Tarsus.fplot.png", Tarsus.fplot, base_height = 4, base_width = 7)
```


## Bill Width Model Comparisons

```{r bill width time 2 model selection}
MinC.BW.mdl <- lm(BW ~ MinC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

MaxC.BW.mdl <- lm(BW ~ MaxC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

GDD10C.BW.mdl <- lm(BW ~ GDD10CSum12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")
```

```{r bill width time 2 model comparison}
BW12_22Mods <- list(MinC.BW.mdl,MaxC.BW.mdl,GDD10C.BW.mdl)
BWTime2ModNames <- c('MinC','MaxC','GDD10C')
aictab(cand.set = BW12_22Mods, modnames = BWTime2ModNames, sort = TRUE)
```

```{r BW best model summary}
summary(MinC.BW.mdl)
```
<br>

Using MinC as the best fit metric from above, here we'll look at whether days 1-11, 12-22, 6-19, or 8-22 differ in how they fit the data.
```{r bill width time period models}
MinC1_11.BW.mdl <- lm(BW ~ MinC1_11 * PrecipSum1_11 + Weight, data = scaled.df, na.action = "na.fail")

MinC12_22.BW.mdl <- lm(BW ~ MinC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

MinC6_19.BW.mdl <- lm(BW ~ MinC6_19 * PrecipSum6_19 + Weight, data = scaled.df, na.action = "na.fail")

MinC8_22.BW.mdl <- lm(BW ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df, na.action = "na.fail")

```

```{r bill width time period model comparison}
BWTimeMods <- list(MinC1_11.BW.mdl,MinC12_22.BW.mdl,MinC6_19.BW.mdl,MinC8_22.BW.mdl)
BWTimeModNames <- c('MinC1_11','MinC12_22','MinC6_19',"MinC8_22")
aictab(cand.set = BWTimeMods, modnames = BWTimeModNames, sort = TRUE)
```
```{r bill width time period best model}
summary(MinC8_22.BW.mdl)
```
<br>

```{r BW MinC8_22.mdl fplot.df}
BW.df <- tidy(MinC8_22.BW.mdl, quick = FALSE)
  ci <- as_tibble(confint(MinC8_22.BW.mdl))
  BW.df$ci.lower <- ci$`2.5 %`
  BW.df$ci.upper <- ci$`97.5 %`
  BW.df$Metric <- "Bill width"
  BW.df <- BW.df[-1,]
```

```{r BW.fplot}
BW.fplot <- ggplot(data = BW.df)+
    geom_errorbar(aes(x=term, ymin=ci.lower, ymax=ci.upper), color = "black", size=1, width=0.3)+
    geom_point(aes(x=term,y=estimate), color = "black", shape = 16, size = 3)+
    coord_flip()+
    geom_hline(yintercept = 0, color="red",size=1, linetype="dotted")+
    scale_x_discrete(labels=c("Min Temp","Min Temp * Precip","Precip","Weight"))+
    #scale_y_continuous(limits = c(-0.3,1))+
    ggtitle("Parameters affecting bill width")+
    ylab("Parameter estimate")+
    theme(plot.title = element_text(size = 16),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 14),
          axis.title.y = element_blank(),
          legend.position = "none",
          plot.margin = margin(15,15,15,15))
BW.fplot
cowplot::save_plot("Plots/BW.fplot.png", BW.fplot, base_height = 4, base_width = 7)
```

## TEC Comparisons

```{r TEC time 2 model selection}
MinC.TEC.mdl <- lm(TEC ~ MinC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

MaxC.TEC.mdl <- lm(TEC ~ MaxC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

GDD10C.TEC.mdl <- lm(TEC ~ GDD10CSum12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")
```

```{r TEC time 2 model comparison}
TEC12_22Mods <- list(MinC.TEC.mdl,MaxC.TEC.mdl,GDD10C.TEC.mdl)
TEC12_22ModNames <- c('MinC','MaxC','GDD10C')
aictab(cand.set = TEC12_22Mods, modnames = TEC12_22ModNames, sort = TRUE)
```
<br>
```{r TEC best model summary}
summary(MinC.TEC.mdl)
```


Using MinC as the best fit metric from above, here we'll look at whether days 1-11, 12-22, 6-19, or 8-22 differ in how they fit the data.
```{r TEC time period models}
MinC1_11.TEC.mdl <- lm(TEC ~ MinC1_11 * PrecipSum1_11 + Weight, data = scaled.df, na.action = "na.fail")

MinC12_22.TEC.mdl <- lm(TEC ~ MinC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

MinC6_19.TEC.mdl <- lm(TEC ~ MinC6_19 * PrecipSum6_19 + Weight, data = scaled.df, na.action = "na.fail")

MinC8_22.TEC.mdl <- lm(TEC ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df, na.action = "na.fail")

```

```{r TEC time period model comparison}
TECTimeMods <- list(MinC1_11.TEC.mdl,MinC12_22.TEC.mdl,MinC6_19.TEC.mdl,MinC8_22.TEC.mdl)
TECTimeModNames <- c('MinC1_11','MinC12_22','MinC6_19',"MinC8_22")
aictab(cand.set = TECTimeMods, modnames = TECTimeModNames, sort = TRUE)
```
<br>

## BNT Comparisons

```{r BNT time 2 model selection}
MinC.BNT.mdl <- lm(BNT ~ MinC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

MaxC.BNT.mdl <- lm(BNT ~ MaxC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

GDD10C.BNT.mdl <- lm(BNT ~ GDD10CSum12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")
```

```{r BNT time 2 model comparison}
BNT12_22Mods <- list(MinC.BNT.mdl,MaxC.BNT.mdl,GDD10C.BNT.mdl)
BNT12_22ModNames <- c('MinC','MaxC','GDD10C')
aictab(cand.set = BNT12_22Mods, modnames = BNT12_22ModNames, sort = TRUE)
```
<br>
```{r BNT best model summary}
summary(MinC.BNT.mdl)
```


Using MinC as the best fit metric from above, here we'll look at whether days 1-11, 12-22, 6-19, or 8-22 differ in how they fit the data.
```{r BNT time period models}
MinC1_11.BNT.mdl <- lm(BNT ~ MinC1_11 * PrecipSum1_11 + Weight, data = scaled.df, na.action = "na.fail")

MinC12_22.BNT.mdl <- lm(BNT ~ MinC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

MinC6_19.BNT.mdl <- lm(BNT ~ MinC6_19 * PrecipSum6_19 + Weight, data = scaled.df, na.action = "na.fail")

MinC8_22.BNT.mdl <- lm(BNT ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df, na.action = "na.fail")

```

```{r BNT time period model comparison}
BNTTimeMods <- list(MinC1_11.BNT.mdl,MinC12_22.BNT.mdl,MinC6_19.BNT.mdl,MinC8_22.BNT.mdl)
BNTTimeModNames <- c('MinC1_11','MinC12_22','MinC6_19',"MinC8_22")
aictab(cand.set = BNTTimeMods, modnames = BNTTimeModNames, sort = TRUE)
```
<br>


## Upper Bill Model Comparisons

```{r UB time 2 model selection}
MinC.UB.mdl <- lm(UB ~ MinC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

MaxC.UB.mdl <- lm(UB ~ MaxC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

GDD10C.UB.mdl <- lm(UB ~ GDD10CSum12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")
```

```{r UB time 2 model comparison}
UB12_22Mods <- list(MinC.UB.mdl,MaxC.UB.mdl,GDD10C.UB.mdl)
UBTime2ModNames <- c('MinC','MaxC','GDD10C')
aictab(cand.set = UB12_22Mods, modnames = UBTime2ModNames, sort = TRUE)
```
```{r UB best model summary}
summary(MinC.UB.mdl)
```
<br>

Using MinC as the best fit metric from above, here we'll look at whether days 1-11, 12-22, 6-19, or 8-22 differ in how they fit the data.
```{r UB time period models}
MinC1_11.UB.mdl <- lm(UB ~ MinC1_11 * PrecipSum1_11 + Weight, data = scaled.df, na.action = "na.fail")

MinC12_22.UB.mdl <- lm(UB ~ MinC12_22 * PrecipSum12_22 + Weight, data = scaled.df, na.action = "na.fail")

MinC6_19.UB.mdl <- lm(UB ~ MinC6_19 * PrecipSum6_19 + Weight, data = scaled.df, na.action = "na.fail")

MinC8_22.UB.mdl <- lm(UB ~ MinC8_22 * PrecipSum8_22 + Weight, data = scaled.df, na.action = "na.fail")

```

```{r UB time period model comparison}
UBTimeMods <- list(MinC1_11.UB.mdl,MinC12_22.UB.mdl,MinC6_19.UB.mdl,MinC8_22.UB.mdl)
UBTimeModNames <- c('MinC1_11','MinC12_22','MinC6_19',"MinC8_22")
aictab(cand.set = UBTimeMods, modnames = UBTimeModNames, sort = TRUE)
```
```{r UB time period best model}
summary(MinC8_22.UB.mdl)
```
<br>

```{r UB interaction plot}
plot_model(MinC6_19.UB.mdl, type = "int", mdrt.values = "meansd")
```


# Bayesian Models

## Bill Depth

Bayesian Bill Depth GDD Incubation model

```{r BD Incubation bayes model}
BDIncub.bmdl <- stan_glm(BD ~ GDDSumIncubation * PrecipSumIncubation + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(BDIncub.bmdl), digits = 3)
#launch_shinystan(BDTime1.bmdl)
```

```{r plot BD ~ GDD Incubation model}
BDGDDIncub.plot <- plot(BDIncub.bmdl, pars = c("GDDSumIncubation","PrecipSumIncubation","Weight","CalcAge","GDDSumIncubation:PrecipSumIncubation"))
#BDGDDIncub.plot
```

<br>

A Frequentist Bill Depth GDD Time 1 model to compare with the Bayesian version

```{r BD Time 1 model}
BDTime1.scaled.mdl <- lm(data = scaled.df, BD ~ GDDSum1_11 * PrecipSum1_11 + Weight + CalcAge)
summary(BDTime1.scaled.mdl)
```

<br>

Bayesian Bill Depth GDD Time 1 model

```{r BD Time 1 bayes model}
BDTime1.bmdl <- stan_glm(BD ~ GDDSum1_11 * PrecipSum1_11 + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(BDTime1.bmdl), digits = 3)
#launch_shinystan(BDTime1.bmdl)
```

```{r plot BD time 1}
BDGDDTime1.plot <- plot(BDTime1.bmdl, pars = c("GDDSum1_11","PrecipSum1_11","Weight","CalcAge","GDDSum1_11:PrecipSum1_11"))
#BDGDDTime1.plot
```

<br>

Bayesian Bill Depth GDD Time 2

```{r BD Time 2 bayes model}
BDTime2.bmdl <- stan_glm(BD ~ GDDSum12_22 * PrecipSum12_22 + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(BDTime2.bmdl), digits = 3)
#launch_shinystan(BDTime1.bmdl)
```

```{r plot BD Time 2 model}
BDGDDTime2.plot <- plot(BDTime2.bmdl, pars = c("GDDSum12_22","PrecipSum12_22","Weight","CalcAge","GDDSum12_22:PrecipSum12_22"))
#BDGDDTime2.plot
```

<br>

Arrange the Bill Depth model plots

```{r ggarrange BD ~ GDD plots}
BDModelPlots.wrap <- ggarrange(BDGDDIncub.plot,BDGDDTime1.plot,BDGDDTime2.plot, ncol = 1)
annotate_figure(BDModelPlots.wrap, top = "Bill Depth Models")
```

<br>

Plot the interaction between GDD and Precip during incubation

```{r BD GDD Incubation Inter plot}
BDGDDIncubInter.plot <- plot_model(BDIncub.bmdl, type = "int", mdrt.values = "quart")

BDGDDIncubInter.plot <- BDGDDIncubInter.plot +
  scale_color_discrete(name="Precip Levels", labels=c("25th Quartile","Median", "75th Quartile"))+
  ylab("Bill Depth")+
  xlab("GDD Incubation")+
  theme(plot.title = element_blank(),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 12),
          axis.title.y = element_text(size = 14),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
#BDGDDIncubInter.plot
```

<br>

Plot the interaction between GDD and Precip during Time 2

```{r BD GDD Time 2 Inter plot}
BDGDDTime2Inter.plot <- plot_model(BDTime2.bmdl, type = "int", mdrt.values = "quart")

BDGDDTime2Inter.plot <- BDGDDTime2Inter.plot +
  scale_color_discrete(name="Precip Levels", labels=c("25th Quartile","Median", "75th Quartile"))+
  ylab("Bill Depth")+
  xlab("GDD Time 2")+
  theme(plot.title = element_blank(),
          axis.text.x = element_text(size = 12),
          axis.title.x = element_text(size = 14),
          axis.text.y = element_text(size = 12),
          axis.title.y = element_text(size = 14),
          legend.position = "top",
          plot.margin = margin(15,15,15,15))
#BDGDDTime2Inter.plot
```

<br>

Arrange interaction plots

```{r BD arrange inter plots}
BDInterPlots.wrap <- ggarrange(BDGDDIncubInter.plot,BDGDDTime2Inter.plot, ncol = 2)
annotate_figure(BDInterPlots.wrap, top = "Bill Depth Interaction Models")
```

<br>

## Upper Bill Models

Bayesian Upper Bill Incubation model

```{r UB Incubation bayes model}
UBIncub.bmdl <- stan_glm(UB ~ GDDSumIncubation * PrecipSumIncubation + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(UBIncub.bmdl), digits = 3)
#launch_shinystan(UBTime1.bmdl)
```

```{r plot UB ~ GDD Incubation model}
UBGDDIncub.plot <- plot(UBIncub.bmdl, pars = c("GDDSumIncubation","PrecipSumIncubation","Weight","CalcAge","GDDSumIncubation:PrecipSumIncubation"))
#UBGDDIncub.plot
```

<br>

Bayesian Upper Bill GDD Time 1 model

```{r UB Time 1 bayes model}
UBTime1.bmdl <- stan_glm(UB ~ GDDSum1_11 * PrecipSum1_11 + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(UBTime1.bmdl), digits = 3)
#launch_shinystan(UBTime1.bmdl)
```

```{r plot UB time 1}
UBGDDTime1.plot <- plot(UBTime1.bmdl, pars = c("GDDSum1_11","PrecipSum1_11","Weight","CalcAge","GDDSum1_11:PrecipSum1_11"))
#UBGDDTime1.plot
```

<br>

Bayesian Upper Bill GDD Time 2

```{r UB Time 2 bayes model}
UBTime2.bmdl <- stan_glm(UB ~ GDDSum12_22 * PrecipSum12_22 + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(UBTime2.bmdl), digits = 3)
#launch_shinystan(UBTime1.bmdl)
```

```{r plot UB Time 2 model}
UBGDDTime2.plot <- plot(UBTime2.bmdl, pars = c("GDDSum12_22","PrecipSum12_22","Weight","CalcAge","GDDSum12_22:PrecipSum12_22"))
#UBGDDTime2.plot
```

<br>

Arrange the Upper Bill model plots

```{r ggarrange UB ~ GDD plots}
UBModelPlots.wrap <- ggarrange(UBGDDIncub.plot,UBGDDTime1.plot,UBGDDTime2.plot, ncol = 1)
annotate_figure(UBModelPlots.wrap, top = "Upper Bill Models")
```

<br>

## Upper Bill Surface Area Models

Bayesian Upper Bill Surface Area Incubation model

```{r UBS Incubation bayes model}
UBSIncub.bmdl <- stan_glm(UBS ~ GDDSumIncubation * PrecipSumIncubation + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(UBSIncub.bmdl), digits = 3)
#launch_shinystan(UBSTime1.bmdl)
```

```{r plot UBS ~ GDD Incubation model}
UBSGDDIncub.plot <- plot(UBSIncub.bmdl, pars = c("GDDSumIncubation","PrecipSumIncubation","Weight","CalcAge","GDDSumIncubation:PrecipSumIncubation"))
#UBSGDDIncub.plot
```

<br>

Bayesian Upper Bill Surface Area GDD Time 1 model

```{r UBS Time 1 bayes model}
UBSTime1.bmdl <- stan_glm(UBS ~ GDDSum1_11 * PrecipSum1_11 + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(UBSTime1.bmdl), digits = 3)
#launch_shinystan(UBSTime1.bmdl)
```

```{r plot UBS time 1}
UBSGDDTime1.plot <- plot(UBSTime1.bmdl, pars = c("GDDSum1_11","PrecipSum1_11","Weight","CalcAge","GDDSum1_11:PrecipSum1_11"))
#UBSGDDTime1.plot
```

<br>

Bayesian Upper Bill Surface Area GDD Time 2

```{r UBS Time 2 bayes model}
UBSTime2.bmdl <- stan_glm(UBS ~ GDDSum12_22 * PrecipSum12_22 + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(UBSTime2.bmdl), digits = 3)
#launch_shinystan(UBSTime1.bmdl)
```

```{r plot UBS Time 2 model}
UBSGDDTime2.plot <- plot(UBSTime2.bmdl, pars = c("GDDSum12_22","PrecipSum12_22","Weight","CalcAge","GDDSum12_22:PrecipSum12_22"))
#UBSGDDTime2.plot
```

<br>

Arrange the Upper Bill Surface Area model plots

```{r ggarrange UBS GDD plots}
UBSModelPlots.wrap <- ggarrange(UBSGDDIncub.plot,UBSGDDTime1.plot,UBSGDDTime2.plot, ncol = 1)
annotate_figure(UBSModelPlots.wrap, top = "Upper Bill Surface Area Models")
```

<br>

## Tarsus Models

Bayesian Tarsus Incubation model

```{r Tarsus Incubation bayes model}
TarsusIncub.bmdl <- stan_glm(Tarsus ~ GDDSumIncubation * PrecipSumIncubation + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(TarsusIncub.bmdl), digits = 3)
#launch_shinystan(TarsusIncub.bmdl)
```

```{r plot Tarsus GDD Incubation model}
TarsusGDDIncub.plot <- plot(TarsusIncub.bmdl, pars = c("GDDSumIncubation","PrecipSumIncubation","Weight","CalcAge","GDDSumIncubation:PrecipSumIncubation"))
#TarsusGDDIncub.plot
```

<br>

Bayesian Tarsus GDD Time 1 model

```{r Tarsus Time 1 bayes model}
TarsusTime1.bmdl <- stan_glm(Tarsus ~ GDDSum1_11 * PrecipSum1_11 + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(TarsusTime1.bmdl), digits = 3)
#launch_shinystan(TarsusTime1.bmdl)
```

```{r plot Tarsus time 1}
TarsusGDDTime1.plot <- plot(TarsusTime1.bmdl, pars = c("GDDSum1_11","PrecipSum1_11","Weight","CalcAge","GDDSum1_11:PrecipSum1_11"))
#TarsusGDDTime1.plot
```

<br>

Bayesian Tarsus GDD Time 2

```{r Tarsus Time 2 bayes model}
TarsusTime2.bmdl <- stan_glm(Tarsus ~ GDDSum12_22 * PrecipSum12_22 + Weight + CalcAge,
                              data = scaled.df,
                              family = gaussian(),
                              algorithm = "sampling",
                              prior = student_t(df = 7, 0, 5), 
                              prior_intercept = student_t(df = 7, 0, 5),
                              cores = 2, seed = 666)
print(summary(TarsusTime2.bmdl), digits = 3)
#launch_shinystan(TarsusTime1.bmdl)
```

```{r plot Tarsus Time 2 model}
TarsusGDDTime2.plot <- plot(TarsusTime2.bmdl, pars = c("GDDSum12_22","PrecipSum12_22","Weight","CalcAge","GDDSum12_22:PrecipSum12_22"))
#TarsusGDDTime2.plot
```

<br>

Arrange the Tarsus model plots

```{r ggarrange Tarsus GDD plots}
TarsusModelPlots.wrap <-ggarrange(TarsusGDDIncub.plot,TarsusGDDTime1.plot,TarsusGDDTime2.plot, ncol = 1)
annotate_figure(TarsusModelPlots.wrap, top = "Tarsus Models")
```

<br>
